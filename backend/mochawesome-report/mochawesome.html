<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets\app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:70,&quot;tests&quot;:196,&quot;passes&quot;:52,&quot;pending&quot;:0,&quot;failures&quot;:144,&quot;start&quot;:&quot;2025-11-13T03:47:14.779Z&quot;,&quot;end&quot;:&quot;2025-11-13T03:47:19.414Z&quot;,&quot;duration&quot;:4635,&quot;testsRegistered&quot;:196,&quot;passPercent&quot;:26.53061224489796,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;10dfaac4-24a8-4c26-ac9c-58df46d80fe5&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8f62febb-1631-4cef-90ab-a41fe22b1715&quot;,&quot;title&quot;:&quot;User Endpoints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\01-user.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\01-user.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;111bae47-4386-4989-93ea-c3beef4bb1df&quot;,&quot;title&quot;:&quot;1. GET /users - Health Check&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\01-user.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\01-user.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return operational status&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 1. GET /users - Health Check should return operational status&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:28,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/users`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.message).to.equal(&#x27;User router is operational&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3355e60d-4075-464f-9437-c68144900f3e&quot;,&quot;parentUUID&quot;:&quot;111bae47-4386-4989-93ea-c3beef4bb1df&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3355e60d-4075-464f-9437-c68144900f3e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:28,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;9ea6c88e-fe42-4590-b72f-5c7a9ad1ebbb&quot;,&quot;title&quot;:&quot;2. POST /users/signup - User Signup&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\01-user.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\01-user.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should register a new buyer account successfully&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 2. POST /users/signup - User Signup should register a new buyer account successfully&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:432,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const userData = {\n  email: `testbuyer_${Date.now()}@example.com`,\n  password: &#x27;testpassword123&#x27;,\n  username: `testbuyer_${Date.now()}`,\n  first_name: &#x27;Test&#x27;,\n  last_name: &#x27;Buyer&#x27;,\n  role: &#x27;buyer&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signup`)\n  .send(userData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;id&#x27;);\nexpect(res.body.id).to.be.a(&#x27;number&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;be5481b8-8ad3-4001-8430-fdcee9a26a82&quot;,&quot;parentUUID&quot;:&quot;9ea6c88e-fe42-4590-b72f-5c7a9ad1ebbb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should register a new seller account successfully&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 2. POST /users/signup - User Signup should register a new seller account successfully&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:110,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const userData = {\n  email: `testseller_${Date.now()}@example.com`,\n  password: &#x27;testpassword123&#x27;,\n  username: `testseller_${Date.now()}`,\n  first_name: &#x27;Test&#x27;,\n  last_name: &#x27;Seller&#x27;,\n  role: &#x27;seller&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signup`)\n  .send(userData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;id&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a5073953-df36-46c8-8aea-a834c2a67a3c&quot;,&quot;parentUUID&quot;:&quot;9ea6c88e-fe42-4590-b72f-5c7a9ad1ebbb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject registration with admin role&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 2. POST /users/signup - User Signup should reject registration with admin role&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const userData = {\n  email: `testadmin_${Date.now()}@example.com`,\n  password: &#x27;testpassword123&#x27;,\n  username: `testadmin_${Date.now()}`,\n  first_name: &#x27;Test&#x27;,\n  last_name: &#x27;Admin&#x27;,\n  role: &#x27;admin&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signup`)\n  .send(userData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 403&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 403\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:75:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 403\n+ 400\n&quot;},&quot;uuid&quot;:&quot;91852321-74ef-4576-a821-5bc566da44b4&quot;,&quot;parentUUID&quot;:&quot;9ea6c88e-fe42-4590-b72f-5c7a9ad1ebbb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject registration with missing fields&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 2. POST /users/signup - User Signup should reject registration with missing fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const userData = {\n  email: `incomplete_${Date.now()}@example.com`,\n  password: &#x27;testpassword123&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signup`)\n  .send(userData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6ad3b58a-1e9f-488a-90f9-bd0b9dbdbf71&quot;,&quot;parentUUID&quot;:&quot;9ea6c88e-fe42-4590-b72f-5c7a9ad1ebbb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;be5481b8-8ad3-4001-8430-fdcee9a26a82&quot;,&quot;a5073953-df36-46c8-8aea-a834c2a67a3c&quot;,&quot;6ad3b58a-1e9f-488a-90f9-bd0b9dbdbf71&quot;],&quot;failures&quot;:[&quot;91852321-74ef-4576-a821-5bc566da44b4&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:549,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;90c48637-a299-4dcd-8f4a-8a51553cdded&quot;,&quot;title&quot;:&quot;3. POST /users/signin - User Sign In&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\01-user.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\01-user.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should login with valid seller credentials&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 3. POST /users/signin - User Sign In should login with valid seller credentials&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:43,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signin`)\n  .send({\n    email: global.testAccounts.seller1.email,\n    password: global.testAccounts.seller1.password\n  });\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;token&#x27;);\nexpect(res.body).to.have.property(&#x27;user&#x27;);\nexpect(res.body.user).to.have.property(&#x27;user_role&#x27;).that.equals(&#x27;seller&#x27;);\n// Store token for later tests\ntokens.seller1 = res.body.token;&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:103:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;75659355-4588-471b-b861-3f2206948655&quot;,&quot;parentUUID&quot;:&quot;90c48637-a299-4dcd-8f4a-8a51553cdded&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should login with valid buyer credentials&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 3. POST /users/signin - User Sign In should login with valid buyer credentials&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:42,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signin`)\n  .send({\n    email: global.testAccounts.buyer1.email,\n    password: global.testAccounts.buyer1.password\n  });\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;token&#x27;);\nexpect(res.body.user).to.have.property(&#x27;user_role&#x27;).that.equals(&#x27;buyer&#x27;);\ntokens.buyer1 = res.body.token;&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:121:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;fa230a1d-ee8a-4dc8-bb62-fd7476aff101&quot;,&quot;parentUUID&quot;:&quot;90c48637-a299-4dcd-8f4a-8a51553cdded&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should login with valid admin credentials&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 3. POST /users/signin - User Sign In should login with valid admin credentials&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:42,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signin`)\n  .send({\n    email: global.testAccounts.admin.email,\n    password: global.testAccounts.admin.password\n  });\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;token&#x27;);\nexpect(res.body.user).to.have.property(&#x27;user_role&#x27;).that.equals(&#x27;admin&#x27;);\ntokens.admin = res.body.token;&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:137:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;cc4bfb3a-1dc0-49ae-888e-b127e61f2675&quot;,&quot;parentUUID&quot;:&quot;90c48637-a299-4dcd-8f4a-8a51553cdded&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject login with invalid credentials&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 3. POST /users/signin - User Sign In should reject login with invalid credentials&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:43,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signin`)\n  .send({\n    email: &#x27;invalid@example.com&#x27;,\n    password: &#x27;wrongpassword&#x27;\n  });\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;219c5370-e176-43e2-b82e-d7cba3964387&quot;,&quot;parentUUID&quot;:&quot;90c48637-a299-4dcd-8f4a-8a51553cdded&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;219c5370-e176-43e2-b82e-d7cba3964387&quot;],&quot;failures&quot;:[&quot;75659355-4588-471b-b861-3f2206948655&quot;,&quot;fa230a1d-ee8a-4dc8-bb62-fd7476aff101&quot;,&quot;cc4bfb3a-1dc0-49ae-888e-b127e61f2675&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:170,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;854bed91-919e-429c-b4cb-ea417e33229d&quot;,&quot;title&quot;:&quot;4. GET /users/verify-token - Verify Token&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\01-user.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\01-user.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should verify valid token&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 4. GET /users/verify-token - Verify Token should verify valid token&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/users/verify-token`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;userId&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:164:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;952ba3c4-69fb-4392-90aa-390c58d1ff81&quot;,&quot;parentUUID&quot;:&quot;854bed91-919e-429c-b4cb-ea417e33229d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject invalid token&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 4. GET /users/verify-token - Verify Token should reject invalid token&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/users/verify-token`)\n  .set(&#x27;Authorization&#x27;, &#x27;Bearer invalid_token_here&#x27;);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:97:28)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:174:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;481a2542-495e-44c8-aa4c-18c8a6981f4a&quot;,&quot;parentUUID&quot;:&quot;854bed91-919e-429c-b4cb-ea417e33229d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject missing token&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 4. GET /users/verify-token - Verify Token should reject missing token&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/users/verify-token`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:97:28)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:182:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;fd17de11-d221-4f26-880f-9512c60c1688&quot;,&quot;parentUUID&quot;:&quot;854bed91-919e-429c-b4cb-ea417e33229d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;952ba3c4-69fb-4392-90aa-390c58d1ff81&quot;,&quot;481a2542-495e-44c8-aa4c-18c8a6981f4a&quot;,&quot;fd17de11-d221-4f26-880f-9512c60c1688&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;0ccb5769-6622-417d-ace2-be492ea6e477&quot;,&quot;title&quot;:&quot;5. PATCH /users/edit-profile - Edit User Profile&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\01-user.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\01-user.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should update user profile successfully&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 5. PATCH /users/edit-profile - Edit User Profile should update user profile successfully&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updateData = {\n  first_name: &#x27;Updated&#x27;,\n  last_name: &#x27;Name&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/users/edit-profile`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send(updateData);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;user&#x27;);\nexpect(res.body.user.first_name).to.equal(&#x27;Updated&#x27;);\nexpect(res.body.user.last_name).to.equal(&#x27;Name&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:199:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;1a195dbb-a156-44f8-88a5-3b42ee38caa9&quot;,&quot;parentUUID&quot;:&quot;0ccb5769-6622-417d-ace2-be492ea6e477&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject profile update without authentication&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 5. PATCH /users/edit-profile - Edit User Profile should reject profile update without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updateData = {\n  first_name: &#x27;Updated&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/users/edit-profile`)\n  .send(updateData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:97:28)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:215:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;f1283c93-4bdd-40c4-a8a1-5a21f91ad7fe&quot;,&quot;parentUUID&quot;:&quot;0ccb5769-6622-417d-ace2-be492ea6e477&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;1a195dbb-a156-44f8-88a5-3b42ee38caa9&quot;,&quot;f1283c93-4bdd-40c4-a8a1-5a21f91ad7fe&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;84e13986-775d-4389-ace8-e2f50d2a7b8b&quot;,&quot;title&quot;:&quot;6. POST /users/change-password - Change Password&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\01-user.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\01-user.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should reject password change with wrong current password&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 6. POST /users/change-password - Change Password should reject password change with wrong current password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/change-password`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send({\n    currentPassword: &#x27;wrongpassword&#x27;,\n    newPassword: &#x27;newpassword123&#x27;\n  });\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:230:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 400\n&quot;},&quot;uuid&quot;:&quot;68477465-5b5e-4673-b970-5c372601587c&quot;,&quot;parentUUID&quot;:&quot;84e13986-775d-4389-ace8-e2f50d2a7b8b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject password change without authentication&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 6. POST /users/change-password - Change Password should reject password change without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/change-password`)\n  .send({\n    currentPassword: &#x27;password123&#x27;,\n    newPassword: &#x27;newpassword123&#x27;\n  });\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:97:28)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:242:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;00712a21-d93d-424e-96cc-85161ce2d172&quot;,&quot;parentUUID&quot;:&quot;84e13986-775d-4389-ace8-e2f50d2a7b8b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;68477465-5b5e-4673-b970-5c372601587c&quot;,&quot;00712a21-d93d-424e-96cc-85161ce2d172&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;ba554a2e-b99f-4a05-9de3-d4c5bb911af5&quot;,&quot;title&quot;:&quot;7. POST /users/super-signup - Create Admin Account&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\01-user.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\01-user.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create admin account with super admin credentials&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 7. POST /users/super-signup - Create Admin Account should create admin account with super admin credentials&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const adminData = {\n  email: `newadmin_${Date.now()}@marketplace.com`,\n  password: &#x27;adminpassword123&#x27;,\n  username: `newadmin_${Date.now()}`,\n  first_name: &#x27;New&#x27;,\n  last_name: &#x27;Admin&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/super-signup`)\n  .auth(global.testAccounts.superAdmin.email, global.testAccounts.superAdmin.password)\n  .send(adminData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;id&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 201 but got 404&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 201 but got 404\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:262:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 201\n&quot;},&quot;uuid&quot;:&quot;42bc7781-b21b-40bc-935a-6e709b88fe9a&quot;,&quot;parentUUID&quot;:&quot;ba554a2e-b99f-4a05-9de3-d4c5bb911af5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject admin creation without super admin auth&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 7. POST /users/super-signup - Create Admin Account should reject admin creation without super admin auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const adminData = {\n  email: `newadmin2_${Date.now()}@marketplace.com`,\n  password: &#x27;adminpassword123&#x27;,\n  username: `newadmin2_${Date.now()}`,\n  first_name: &#x27;New&#x27;,\n  last_name: &#x27;Admin&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/super-signup`)\n  .send(adminData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 401 but got 404&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 401 but got 404\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:280:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 401\n&quot;},&quot;uuid&quot;:&quot;00811dc1-d0b6-4638-b94f-e22b8b58a6df&quot;,&quot;parentUUID&quot;:&quot;ba554a2e-b99f-4a05-9de3-d4c5bb911af5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;42bc7781-b21b-40bc-935a-6e709b88fe9a&quot;,&quot;00811dc1-d0b6-4638-b94f-e22b8b58a6df&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;07b65c20-94f4-4eb3-9d3a-b8c743b753a4&quot;,&quot;title&quot;:&quot;8. DELETE /users/delete-user - Delete User&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\01-user.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\01-user.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;8. DELETE /users/delete-user - Delete User\&quot;&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 8. DELETE /users/delete-user - Delete User \&quot;before all\&quot; hook in \&quot;8. DELETE /users/delete-user - Delete User\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:131,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Create a user to delete\nconst userData = {\n  email: `todelete_${Date.now()}@example.com`,\n  password: &#x27;password123&#x27;,\n  username: `todelete_${Date.now()}`,\n  first_name: &#x27;To&#x27;,\n  last_name: &#x27;Delete&#x27;,\n  role: &#x27;buyer&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signup`)\n  .send(userData);\nuserIdToDelete = res.body.id;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;619a6fbc-83d3-4629-864d-2100b6436fb3&quot;,&quot;parentUUID&quot;:&quot;07b65c20-94f4-4eb3-9d3a-b8c743b753a4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should delete user with super admin credentials&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 8. DELETE /users/delete-user - Delete User should delete user with super admin credentials&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/users/delete-user`)\n  .auth(global.testAccounts.superAdmin.email, global.testAccounts.superAdmin.password)\n  .send({ user_id: userIdToDelete });\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;deletedUser&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 200 but got 404&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 200 but got 404\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:313:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 200\n&quot;},&quot;uuid&quot;:&quot;23911e47-77b2-477f-b5d7-fbecd62f38e5&quot;,&quot;parentUUID&quot;:&quot;07b65c20-94f4-4eb3-9d3a-b8c743b753a4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject user deletion without super admin auth&quot;,&quot;fullTitle&quot;:&quot;User Endpoints 8. DELETE /users/delete-user - Delete User should reject user deletion without super admin auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/users/delete-user`)\n  .send({ user_id: 999999 });\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 401 but got 404&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 401 but got 404\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/01-user.test.js:323:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 401\n&quot;},&quot;uuid&quot;:&quot;c93b5def-0a5d-42b5-9e46-36237829f6b6&quot;,&quot;parentUUID&quot;:&quot;07b65c20-94f4-4eb3-9d3a-b8c743b753a4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;23911e47-77b2-477f-b5d7-fbecd62f38e5&quot;,&quot;c93b5def-0a5d-42b5-9e46-36237829f6b6&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;791bc920-b966-405d-91e4-fc45c8655a3e&quot;,&quot;title&quot;:&quot;Listing Endpoints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\02-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\02-listing.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;46a73956-cac3-4749-a763-0f10a5065adf&quot;,&quot;title&quot;:&quot;9. GET /listings - Get All Listings&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\02-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\02-listing.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get all active listings without filters&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 9. GET /listings - Get All Listings should get all active listings without filters&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:118,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;listings&#x27;);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);\nexpect(res.body).to.have.property(&#x27;pagination&#x27;);\nvalidatePagination(res.body.pagination);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { page: 1, limit: 20, …(2) } to have property &#x27;currentPage&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { page: 1, limit: 20, …(2) } to have property &#x27;currentPage&#x27;\n    at validatePagination (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:106:30)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:22:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;4a7aad50-c57f-4491-808b-6efe5815487a&quot;,&quot;parentUUID&quot;:&quot;46a73956-cac3-4749-a763-0f10a5065adf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should filter listings by search query&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 9. GET /listings - Get All Listings should filter listings by search query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:80,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings?q=phone`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b399a99e-09a2-4e66-982a-9c792c5e1ada&quot;,&quot;parentUUID&quot;:&quot;46a73956-cac3-4749-a763-0f10a5065adf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should filter listings by price range&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 9. GET /listings - Get All Listings should filter listings by price range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:79,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings?minPrice=1000&amp;maxPrice=50000`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;64c53d8c-dccf-459a-b821-450d06045097&quot;,&quot;parentUUID&quot;:&quot;46a73956-cac3-4749-a763-0f10a5065adf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should sort listings by newest&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 9. GET /listings - Get All Listings should sort listings by newest&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:79,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings?sort=newest`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9abad0b4-7457-4403-bed3-fd6a2c5e0feb&quot;,&quot;parentUUID&quot;:&quot;46a73956-cac3-4749-a763-0f10a5065adf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should paginate results&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 9. GET /listings - Get All Listings should paginate results&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:77,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings?page=1&amp;limit=5`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.pagination.itemsPerPage).to.equal(5);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected undefined to equal 5&quot;,&quot;estack&quot;:&quot;AssertionError: expected undefined to equal 5\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:58:51)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;32ca2fd7-af2a-44cc-83a8-864c068564d9&quot;,&quot;parentUUID&quot;:&quot;46a73956-cac3-4749-a763-0f10a5065adf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b399a99e-09a2-4e66-982a-9c792c5e1ada&quot;,&quot;64c53d8c-dccf-459a-b821-450d06045097&quot;,&quot;9abad0b4-7457-4403-bed3-fd6a2c5e0feb&quot;],&quot;failures&quot;:[&quot;4a7aad50-c57f-4491-808b-6efe5815487a&quot;,&quot;32ca2fd7-af2a-44cc-83a8-864c068564d9&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:433,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;7af08c93-a8ec-497b-a4d8-d24f195e386d&quot;,&quot;title&quot;:&quot;10. GET /listings/:id - Get Single Listing&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\02-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\02-listing.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get listing details by ID&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 10. GET /listings/:id - Get Single Listing should get listing details by ID&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings/1`);\nif (res.status === 200) {\n  validateSuccessResponse(res, 200);\n  expect(res.body).to.have.property(&#x27;listing&#x27;);\n  expect(res.body.listing).to.have.property(&#x27;listing_id&#x27;);\n  expect(res.body.listing).to.have.property(&#x27;title&#x27;);\n  expect(res.body.listing).to.have.property(&#x27;price&#x27;);\n} else {\n  validateErrorResponse(res, 404);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;48b0b666-6583-4be4-9084-ee2a97f13417&quot;,&quot;parentUUID&quot;:&quot;7af08c93-a8ec-497b-a4d8-d24f195e386d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for non-existent listing&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 10. GET /listings/:id - Get Single Listing should return 404 for non-existent listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:76,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings/999999`);\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;873764a4-43b5-4438-b91c-89577204955e&quot;,&quot;parentUUID&quot;:&quot;7af08c93-a8ec-497b-a4d8-d24f195e386d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;48b0b666-6583-4be4-9084-ee2a97f13417&quot;,&quot;873764a4-43b5-4438-b91c-89577204955e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:152,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;5d4a29c7-d511-42ff-8e16-9b59442d8868&quot;,&quot;title&quot;:&quot;11. POST /listings - Create Listing&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\02-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\02-listing.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a new listing as seller&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 11. POST /listings - Create Listing should create a new listing as seller&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const listingData = {\n  categoryId: 1,\n  title: `Test Listing ${Date.now()}`,\n  description: &#x27;This is a test listing for automated testing&#x27;,\n  price: 15000,\n  location: &#x27;Bangkok&#x27;,\n  images: []\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/listings`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send(listingData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;listingId&#x27;);\n// Store for later tests\ntestListingId = res.body.listingId;\ntestData.listingIds.test1 = testListingId;&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:105:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 201\n&quot;},&quot;uuid&quot;:&quot;6df1d845-4dd5-4e91-b2f3-ed4d6b71a024&quot;,&quot;parentUUID&quot;:&quot;5d4a29c7-d511-42ff-8e16-9b59442d8868&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject listing creation without authentication&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 11. POST /listings - Create Listing should reject listing creation without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const listingData = {\n  categoryId: 1,\n  title: &#x27;Test Listing&#x27;,\n  description: &#x27;Test description&#x27;,\n  price: 15000,\n  location: &#x27;Bangkok&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/listings`)\n  .send(listingData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f146c59f-3d3f-44fc-99a6-edc429668361&quot;,&quot;parentUUID&quot;:&quot;5d4a29c7-d511-42ff-8e16-9b59442d8868&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject listing with missing required fields&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 11. POST /listings - Create Listing should reject listing with missing required fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const listingData = {\n  title: &#x27;Incomplete Listing&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/listings`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send(listingData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:141:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 400\n&quot;},&quot;uuid&quot;:&quot;1e20cb51-22ca-4315-b545-1441bbba3e28&quot;,&quot;parentUUID&quot;:&quot;5d4a29c7-d511-42ff-8e16-9b59442d8868&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject listing creation by buyer&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 11. POST /listings - Create Listing should reject listing creation by buyer&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const listingData = {\n  categoryId: 1,\n  title: &#x27;Buyer Test Listing&#x27;,\n  description: &#x27;Test description&#x27;,\n  price: 15000,\n  location: &#x27;Bangkok&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/listings`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(listingData);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:159:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;26784e08-4337-4b40-b097-7f04bc88766d&quot;,&quot;parentUUID&quot;:&quot;5d4a29c7-d511-42ff-8e16-9b59442d8868&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f146c59f-3d3f-44fc-99a6-edc429668361&quot;],&quot;failures&quot;:[&quot;6df1d845-4dd5-4e91-b2f3-ed4d6b71a024&quot;,&quot;1e20cb51-22ca-4315-b545-1441bbba3e28&quot;,&quot;26784e08-4337-4b40-b097-7f04bc88766d&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;69d189d0-fafb-4a4d-8804-d64bf72908a1&quot;,&quot;title&quot;:&quot;12. GET /listings/my/listings - Get My Listings&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\02-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\02-listing.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get seller&#x27;s own listings&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 12. GET /listings/my/listings - Get My Listings should get seller&#x27;s own listings&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings/my/listings`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;listings&#x27;);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:170:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;21c885d4-8b44-40a9-9fcf-5c1c2f5ffe90&quot;,&quot;parentUUID&quot;:&quot;69d189d0-fafb-4a4d-8804-d64bf72908a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject without authentication&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 12. GET /listings/my/listings - Get My Listings should reject without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings/my/listings`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a39ed577-3550-4397-a915-40a39b1b5570&quot;,&quot;parentUUID&quot;:&quot;69d189d0-fafb-4a4d-8804-d64bf72908a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a39ed577-3550-4397-a915-40a39b1b5570&quot;],&quot;failures&quot;:[&quot;21c885d4-8b44-40a9-9fcf-5c1c2f5ffe90&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;96af73cd-7f8b-4bb3-8e09-b4eebc4d6aee&quot;,&quot;title&quot;:&quot;13. PUT /listings/:id - Update Listing&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\02-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\02-listing.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should update listing as owner&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 13. PUT /listings/:id - Update Listing should update listing as owner&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updateData = {\n  title: `Updated Listing ${Date.now()}`,\n  description: &#x27;Updated description&#x27;,\n  price: 20000\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/listings/${testListingId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send(updateData);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;listing&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:198:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;d3c67c5a-99bb-41f6-881f-e88c49fd11dd&quot;,&quot;parentUUID&quot;:&quot;96af73cd-7f8b-4bb3-8e09-b4eebc4d6aee&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject update by non-owner&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 13. PUT /listings/:id - Update Listing should reject update by non-owner&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updateData = {\n  title: &#x27;Unauthorized Update&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/listings/${testListingId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(updateData);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:213:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;b4218948-ccb1-458b-84cd-10851b883a60&quot;,&quot;parentUUID&quot;:&quot;96af73cd-7f8b-4bb3-8e09-b4eebc4d6aee&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject update without authentication&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 13. PUT /listings/:id - Update Listing should reject update without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updateData = {\n  title: &#x27;No Auth Update&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/listings/${testListingId}`)\n  .send(updateData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8ac185ee-9ecd-4205-90f9-d6420c6253ba&quot;,&quot;parentUUID&quot;:&quot;96af73cd-7f8b-4bb3-8e09-b4eebc4d6aee&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8ac185ee-9ecd-4205-90f9-d6420c6253ba&quot;],&quot;failures&quot;:[&quot;d3c67c5a-99bb-41f6-881f-e88c49fd11dd&quot;,&quot;b4218948-ccb1-458b-84cd-10851b883a60&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;70de5c10-e360-46ab-a7c4-551c04dce9b0&quot;,&quot;title&quot;:&quot;14. PATCH /listings/:id/status - Update Listing Status&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\02-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\02-listing.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should update listing status to sold&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 14. PATCH /listings/:id/status - Update Listing Status should update listing status to sold&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/listings/${testListingId}/status`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send({ status: &#x27;sold&#x27; });\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;listing&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:238:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;338b095c-89a7-4d47-ae88-1fdde1f89e02&quot;,&quot;parentUUID&quot;:&quot;70de5c10-e360-46ab-a7c4-551c04dce9b0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should update listing status to active&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 14. PATCH /listings/:id/status - Update Listing Status should update listing status to active&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/listings/${testListingId}/status`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send({ status: &#x27;active&#x27; });\nvalidateSuccessResponse(res, 200);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:249:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;88a3c9db-b8a8-48d1-b231-e68c7d7e3915&quot;,&quot;parentUUID&quot;:&quot;70de5c10-e360-46ab-a7c4-551c04dce9b0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject invalid status&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 14. PATCH /listings/:id/status - Update Listing Status should reject invalid status&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/listings/${testListingId}/status`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send({ status: &#x27;invalid_status&#x27; });\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:259:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 400\n&quot;},&quot;uuid&quot;:&quot;4811aeee-64e1-4ab6-8c89-f7f104000012&quot;,&quot;parentUUID&quot;:&quot;70de5c10-e360-46ab-a7c4-551c04dce9b0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;338b095c-89a7-4d47-ae88-1fdde1f89e02&quot;,&quot;88a3c9db-b8a8-48d1-b231-e68c7d7e3915&quot;,&quot;4811aeee-64e1-4ab6-8c89-f7f104000012&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;d7b46a76-4ac6-4349-9466-7758cc591903&quot;,&quot;title&quot;:&quot;15. DELETE /listings/:id - Delete Listing&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\02-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\02-listing.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;15. DELETE /listings/:id - Delete Listing\&quot;&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 15. DELETE /listings/:id - Delete Listing \&quot;before all\&quot; hook in \&quot;15. DELETE /listings/:id - Delete Listing\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Create a listing to delete\nconst listingData = {\n  categoryId: 1,\n  title: `To Delete ${Date.now()}`,\n  description: &#x27;This listing will be deleted&#x27;,\n  price: 10000,\n  location: &#x27;Bangkok&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/listings`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send(listingData);\nlistingToDelete = res.body.listingId;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8380182b-e70c-408b-8b4f-29772d2eaf54&quot;,&quot;parentUUID&quot;:&quot;d7b46a76-4ac6-4349-9466-7758cc591903&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should delete listing as owner&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 15. DELETE /listings/:id - Delete Listing should delete listing as owner&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/listings/${listingToDelete}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`);\nvalidateSuccessResponse(res, 200);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:291:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;d7a148de-bb51-4230-a9d4-3b3498357418&quot;,&quot;parentUUID&quot;:&quot;d7b46a76-4ac6-4349-9466-7758cc591903&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject deletion without authentication&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 15. DELETE /listings/:id - Delete Listing should reject deletion without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/listings/999`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5bc635c4-47b7-4a54-b82c-66e6a5b766ff&quot;,&quot;parentUUID&quot;:&quot;d7b46a76-4ac6-4349-9466-7758cc591903&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5bc635c4-47b7-4a54-b82c-66e6a5b766ff&quot;],&quot;failures&quot;:[&quot;d7a148de-bb51-4230-a9d4-3b3498357418&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;9bad842b-ea22-4714-ba00-8f4c519d1cfa&quot;,&quot;title&quot;:&quot;16. POST /listings/:id/images - Add Images to Listing&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\02-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\02-listing.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should add images to listing&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 16. POST /listings/:id/images - Add Images to Listing should add images to listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const imageData = {\n  images: [\n    &#x27;https://utfs.io/f/test-image-1.jpg&#x27;,\n    &#x27;https://utfs.io/f/test-image-2.jpg&#x27;\n  ]\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/listings/${testListingId}/images`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send(imageData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;images&#x27;);\nexpect(res.body.images).to.be.an(&#x27;array&#x27;);\nif (res.body.images &amp;&amp; res.body.images.length &gt; 0) {\n  testImageId = res.body.images[0].image_id;\n}&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:318:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 201\n&quot;},&quot;uuid&quot;:&quot;4ef8b322-60b7-45ee-b78c-7f4a17dd5022&quot;,&quot;parentUUID&quot;:&quot;9bad842b-ea22-4714-ba00-8f4c519d1cfa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject adding images without authentication&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 16. POST /listings/:id/images - Add Images to Listing should reject adding images without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const imageData = {\n  images: [\n    &#x27;https://utfs.io/f/test.jpg&#x27;\n  ]\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/listings/${testListingId}/images`)\n  .send(imageData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c53e3c44-0958-4b72-b37e-6b99479d260d&quot;,&quot;parentUUID&quot;:&quot;9bad842b-ea22-4714-ba00-8f4c519d1cfa&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c53e3c44-0958-4b72-b37e-6b99479d260d&quot;],&quot;failures&quot;:[&quot;4ef8b322-60b7-45ee-b78c-7f4a17dd5022&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;ff1fcfff-c8f1-419c-b2cf-10edc6661a5a&quot;,&quot;title&quot;:&quot;17. DELETE /listings/images/:imageId - Delete Listing Image&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\02-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\02-listing.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should delete listing image&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 17. DELETE /listings/images/:imageId - Delete Listing Image should delete listing image&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testImageId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/listings/images/${testImageId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`);\nvalidateSuccessResponse(res, 200);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/02-listing.test.js:346:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;0d55fba9-4beb-4771-b064-06a7d036f52d&quot;,&quot;parentUUID&quot;:&quot;ff1fcfff-c8f1-419c-b2cf-10edc6661a5a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject image deletion without authentication&quot;,&quot;fullTitle&quot;:&quot;Listing Endpoints 17. DELETE /listings/images/:imageId - Delete Listing Image should reject image deletion without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/listings/images/999`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;521539fb-ff65-4154-b93f-a5e05046c533&quot;,&quot;parentUUID&quot;:&quot;ff1fcfff-c8f1-419c-b2cf-10edc6661a5a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;521539fb-ff65-4154-b93f-a5e05046c533&quot;],&quot;failures&quot;:[&quot;0d55fba9-4beb-4771-b064-06a7d036f52d&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;db407c25-6c56-4b5e-9489-336247d9faa4&quot;,&quot;title&quot;:&quot;Seller Endpoints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\03-seller.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\03-seller.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Seller Endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints \&quot;before all\&quot; hook in \&quot;Seller Endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:39,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Get seller ID by signing in\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signin`)\n  .send({\n    email: global.testAccounts.seller1.email,\n    password: global.testAccounts.seller1.password\n  });\nif (res.body.success) {\n  sellerId = res.body.user.user_id;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;80637662-1e8a-4f89-a292-f00c265f295e&quot;,&quot;parentUUID&quot;:&quot;db407c25-6c56-4b5e-9489-336247d9faa4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;27df2f8a-96e3-4535-8387-7341caa8678b&quot;,&quot;title&quot;:&quot;18. GET /sellers/:userId - Get Seller Information&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\03-seller.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\03-seller.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get seller information by ID&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 18. GET /sellers/:userId - Get Seller Information should get seller information by ID&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/${sellerId}`);\nif (res.status === 200) {\n  validateSuccessResponse(res, 200);\n  expect(res.body).to.have.property(&#x27;seller&#x27;);\n  expect(res.body.seller).to.have.property(&#x27;user_id&#x27;);\n  expect(res.body.seller).to.have.property(&#x27;username&#x27;);\n  expect(res.body.seller).to.have.property(&#x27;user_role&#x27;).that.equals(&#x27;seller&#x27;);\n} else {\n  validateErrorResponse(res, 404);\n}&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 400\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/03-seller.test.js:39:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 404\n&quot;},&quot;uuid&quot;:&quot;7e658cb1-9b2d-4fe8-a594-b0ea2f6ca35a&quot;,&quot;parentUUID&quot;:&quot;27df2f8a-96e3-4535-8387-7341caa8678b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for non-existent seller&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 18. GET /sellers/:userId - Get Seller Information should return 404 for non-existent seller&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:40,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/999999`);\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2a0a2924-3689-442e-bf8f-cf3117e09d26&quot;,&quot;parentUUID&quot;:&quot;27df2f8a-96e3-4535-8387-7341caa8678b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 400 for non-seller user ID&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 18. GET /sellers/:userId - Get Seller Information should return 400 for non-seller user ID&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:39,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Try to get buyer as seller\nconst buyerRes = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signin`)\n  .send({\n    email: global.testAccounts.buyer1.email,\n    password: global.testAccounts.buyer1.password\n  });\nif (buyerRes.body.success) {\n  const buyerId = buyerRes.body.user.user_id;\n  const res = await chai\n    .request(baseURL)\n    .get(`${apiPrefix}/sellers/${buyerId}`);\n  validateErrorResponse(res, 400);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;909ad73f-e8b6-44d4-be80-f25c56f72c5a&quot;,&quot;parentUUID&quot;:&quot;27df2f8a-96e3-4535-8387-7341caa8678b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2a0a2924-3689-442e-bf8f-cf3117e09d26&quot;,&quot;909ad73f-e8b6-44d4-be80-f25c56f72c5a&quot;],&quot;failures&quot;:[&quot;7e658cb1-9b2d-4fe8-a594-b0ea2f6ca35a&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:98,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;1c5ba51c-f29c-4aca-825e-1b9ee9fced9e&quot;,&quot;title&quot;:&quot;19. GET /sellers/:userId/listings - Get Seller Listings&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\03-seller.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\03-seller.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get all listings from a seller&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 19. GET /sellers/:userId/listings - Get Seller Listings should get all listings from a seller&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/${sellerId}/listings`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;listings&#x27;);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);\nexpect(res.body).to.have.property(&#x27;pagination&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/03-seller.test.js:78:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 200\n&quot;},&quot;uuid&quot;:&quot;9d122f46-ec90-4d1d-94d8-01dd0cc633d2&quot;,&quot;parentUUID&quot;:&quot;1c5ba51c-f29c-4aca-825e-1b9ee9fced9e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should filter seller listings by search query&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 19. GET /sellers/:userId/listings - Get Seller Listings should filter seller listings by search query&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/${sellerId}/listings?q=test`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/03-seller.test.js:89:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 200\n&quot;},&quot;uuid&quot;:&quot;2df4c42f-e8fc-43ef-8202-e3d1b8da9c37&quot;,&quot;parentUUID&quot;:&quot;1c5ba51c-f29c-4aca-825e-1b9ee9fced9e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should filter seller listings by price range&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 19. GET /sellers/:userId/listings - Get Seller Listings should filter seller listings by price range&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/${sellerId}/listings?minPrice=1000&amp;maxPrice=50000`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/03-seller.test.js:98:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 200\n&quot;},&quot;uuid&quot;:&quot;d82a5d05-928b-4cf4-84c1-3faa20b54e2a&quot;,&quot;parentUUID&quot;:&quot;1c5ba51c-f29c-4aca-825e-1b9ee9fced9e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should filter seller listings by status&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 19. GET /sellers/:userId/listings - Get Seller Listings should filter seller listings by status&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/${sellerId}/listings?status=active`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/03-seller.test.js:107:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 200\n&quot;},&quot;uuid&quot;:&quot;9a0faac2-a1f2-495b-a7e4-cee8012e4d7c&quot;,&quot;parentUUID&quot;:&quot;1c5ba51c-f29c-4aca-825e-1b9ee9fced9e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should sort seller listings&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 19. GET /sellers/:userId/listings - Get Seller Listings should sort seller listings&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/${sellerId}/listings?sort=price_low`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/03-seller.test.js:116:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 200\n&quot;},&quot;uuid&quot;:&quot;048f347e-f29b-43e1-9f3e-b14627531025&quot;,&quot;parentUUID&quot;:&quot;1c5ba51c-f29c-4aca-825e-1b9ee9fced9e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should paginate seller listings&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 19. GET /sellers/:userId/listings - Get Seller Listings should paginate seller listings&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/${sellerId}/listings?page=1&amp;limit=5`);\nvalidateSuccessResponse(res, 200);\nif (res.body.pagination) {\n  expect(res.body.pagination.itemsPerPage).to.equal(5);\n}&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/03-seller.test.js:125:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 200\n&quot;},&quot;uuid&quot;:&quot;8a35815e-bffc-4150-b1af-569b01304182&quot;,&quot;parentUUID&quot;:&quot;1c5ba51c-f29c-4aca-825e-1b9ee9fced9e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;9d122f46-ec90-4d1d-94d8-01dd0cc633d2&quot;,&quot;2df4c42f-e8fc-43ef-8202-e3d1b8da9c37&quot;,&quot;d82a5d05-928b-4cf4-84c1-3faa20b54e2a&quot;,&quot;9a0faac2-a1f2-495b-a7e4-cee8012e4d7c&quot;,&quot;048f347e-f29b-43e1-9f3e-b14627531025&quot;,&quot;8a35815e-bffc-4150-b1af-569b01304182&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;d7bf7c26-b20b-46eb-b39d-4156dd652ac2&quot;,&quot;title&quot;:&quot;20. GET /sellers/:userId/reviews - Get Seller Reviews&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\03-seller.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\03-seller.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get seller reviews&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 20. GET /sellers/:userId/reviews - Get Seller Reviews should get seller reviews&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/${sellerId}/reviews`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;reviews&#x27;);\nexpect(res.body.reviews).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/03-seller.test.js:138:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 200\n&quot;},&quot;uuid&quot;:&quot;54b1fdec-e2a3-48dd-ab46-2ff32d506260&quot;,&quot;parentUUID&quot;:&quot;d7bf7c26-b20b-46eb-b39d-4156dd652ac2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should paginate seller reviews&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 20. GET /sellers/:userId/reviews - Get Seller Reviews should paginate seller reviews&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/${sellerId}/reviews?limit=10&amp;offset=0`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.reviews).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/03-seller.test.js:148:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 200\n&quot;},&quot;uuid&quot;:&quot;5ce7ecd9-6130-45ff-b5ae-9a9e450e184b&quot;,&quot;parentUUID&quot;:&quot;d7bf7c26-b20b-46eb-b39d-4156dd652ac2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return empty array for seller with no reviews&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 20. GET /sellers/:userId/reviews - Get Seller Reviews should return empty array for seller with no reviews&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/${sellerId}/reviews`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.reviews).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/03-seller.test.js:157:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 200\n&quot;},&quot;uuid&quot;:&quot;5f0a39ab-b0f8-499a-b585-e4885a646ea0&quot;,&quot;parentUUID&quot;:&quot;d7bf7c26-b20b-46eb-b39d-4156dd652ac2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;54b1fdec-e2a3-48dd-ab46-2ff32d506260&quot;,&quot;5ce7ecd9-6130-45ff-b5ae-9a9e450e184b&quot;,&quot;5f0a39ab-b0f8-499a-b585-e4885a646ea0&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;6731781f-fca4-46a3-b913-55ad8eb0dcc3&quot;,&quot;title&quot;:&quot;21. GET /sellers/:userId/stats - Get Seller Statistics&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\03-seller.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\03-seller.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get seller statistics&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 21. GET /sellers/:userId/stats - Get Seller Statistics should get seller statistics&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/${sellerId}/stats`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;stats&#x27;);\nexpect(res.body.stats).to.be.an(&#x27;object&#x27;);\nexpect(res.body.stats).to.have.property(&#x27;total_listings&#x27;);\nexpect(res.body.stats).to.have.property(&#x27;active_listings&#x27;);\nexpect(res.body.stats).to.have.property(&#x27;sold_listings&#x27;);\nexpect(res.body.stats).to.have.property(&#x27;total_views&#x27;);\nexpect(res.body.stats).to.have.property(&#x27;total_reviews&#x27;);\nexpect(res.body.stats).to.have.property(&#x27;average_rating&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/03-seller.test.js:168:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 200\n&quot;},&quot;uuid&quot;:&quot;f22c8547-8b05-490e-bb3f-a42614f48c78&quot;,&quot;parentUUID&quot;:&quot;6731781f-fca4-46a3-b913-55ad8eb0dcc3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return stats for seller with no activity&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 21. GET /sellers/:userId/stats - Get Seller Statistics should return stats for seller with no activity&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/${sellerId}/stats`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.stats).to.be.an(&#x27;object&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/03-seller.test.js:184:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 200\n&quot;},&quot;uuid&quot;:&quot;a35212d8-1fd2-475c-ab07-4cd5807cc2a8&quot;,&quot;parentUUID&quot;:&quot;6731781f-fca4-46a3-b913-55ad8eb0dcc3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for non-existent seller&quot;,&quot;fullTitle&quot;:&quot;Seller Endpoints 21. GET /sellers/:userId/stats - Get Seller Statistics should return 404 for non-existent seller&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:39,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/sellers/999999/stats`);\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f86a783d-fc15-46b2-91b4-979f25bcdae8&quot;,&quot;parentUUID&quot;:&quot;6731781f-fca4-46a3-b913-55ad8eb0dcc3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f86a783d-fc15-46b2-91b4-979f25bcdae8&quot;],&quot;failures&quot;:[&quot;f22c8547-8b05-490e-bb3f-a42614f48c78&quot;,&quot;a35212d8-1fd2-475c-ab07-4cd5807cc2a8&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:43,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;1fdf23f6-f58b-4bb4-8841-14778e27ca04&quot;,&quot;title&quot;:&quot;Category Endpoints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\04-category.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\04-category.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;c8fffef3-65e7-4c6f-8cde-77140ddb8dd1&quot;,&quot;title&quot;:&quot;22. GET /categories - Get All Categories&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\04-category.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\04-category.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get all categories&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 22. GET /categories - Get All Categories should get all categories&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:40,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/categories`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;categories&#x27;);\nexpect(res.body.categories).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a27f1f07-9368-4504-a66a-be1661773bb8&quot;,&quot;parentUUID&quot;:&quot;c8fffef3-65e7-4c6f-8cde-77140ddb8dd1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return categories with proper structure&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 22. GET /categories - Get All Categories should return categories with proper structure&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:39,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/categories`);\nvalidateSuccessResponse(res, 200);\nif (res.body.categories.length &gt; 0) {\n  const category = res.body.categories[0];\n  expect(category).to.have.property(&#x27;category_id&#x27;);\n  expect(category).to.have.property(&#x27;category_name&#x27;);\n  expect(category).to.have.property(&#x27;slug&#x27;);\n}&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { category_id: 1, …(7) } to have property &#x27;category_name&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { category_id: 1, …(7) } to have property &#x27;category_name&#x27;\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/04-category.test.js:32:34)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;8a6f3ca3-9a93-400a-be96-f9b1cb556149&quot;,&quot;parentUUID&quot;:&quot;c8fffef3-65e7-4c6f-8cde-77140ddb8dd1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a27f1f07-9368-4504-a66a-be1661773bb8&quot;],&quot;failures&quot;:[&quot;8a6f3ca3-9a93-400a-be96-f9b1cb556149&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:79,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;930ef1ef-9e05-4c53-ac20-78ffb8feede6&quot;,&quot;title&quot;:&quot;23. GET /categories/:slug - Get Category by Slug&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\04-category.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\04-category.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;23. GET /categories/:slug - Get Category by Slug\&quot;&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 23. GET /categories/:slug - Get Category by Slug \&quot;before all\&quot; hook in \&quot;23. GET /categories/:slug - Get Category by Slug\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:40,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Get a category slug from the list\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/categories`);\nif (res.body.success &amp;&amp; res.body.categories.length &gt; 0) {\n  testCategorySlug = res.body.categories[0].slug;\n  testCategoryId = res.body.categories[0].category_id;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a1363c22-639f-4e9b-af9b-861bdf517f7b&quot;,&quot;parentUUID&quot;:&quot;930ef1ef-9e05-4c53-ac20-78ffb8feede6&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get category by slug&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 23. GET /categories/:slug - Get Category by Slug should get category by slug&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:111,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testCategorySlug) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/categories/${testCategorySlug}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;category&#x27;);\nexpect(res.body.category).to.have.property(&#x27;slug&#x27;).that.equals(testCategorySlug);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2cb4bf37-5eee-4bf3-976d-72e6b4c07922&quot;,&quot;parentUUID&quot;:&quot;930ef1ef-9e05-4c53-ac20-78ffb8feede6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for non-existent slug&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 23. GET /categories/:slug - Get Category by Slug should return 404 for non-existent slug&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:39,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/categories/non-existent-slug-12345`);\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;339954db-3b5d-4937-bd8c-b5c61b4d1eb9&quot;,&quot;parentUUID&quot;:&quot;930ef1ef-9e05-4c53-ac20-78ffb8feede6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2cb4bf37-5eee-4bf3-976d-72e6b4c07922&quot;,&quot;339954db-3b5d-4937-bd8c-b5c61b4d1eb9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:150,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;9d8b3c4c-b977-40ec-a186-349d876e526c&quot;,&quot;title&quot;:&quot;24. GET /categories/:slug/listings - Get Listings by Category&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\04-category.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\04-category.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get listings for a category&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 24. GET /categories/:slug/listings - Get Listings by Category should get listings for a category&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testCategorySlug) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/categories/${testCategorySlug}/listings`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;listings&#x27;);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);\nexpect(res.body).to.have.property(&#x27;pagination&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0608090e-c20b-474f-b50c-a496fb010aaf&quot;,&quot;parentUUID&quot;:&quot;9d8b3c4c-b977-40ec-a186-349d876e526c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should filter category listings with pagination&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 24. GET /categories/:slug/listings - Get Listings by Category should filter category listings with pagination&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testCategorySlug) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/categories/${testCategorySlug}/listings?page=1&amp;limit=10`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;55dbe65a-2a2e-41ec-a633-a4ba5b94eebf&quot;,&quot;parentUUID&quot;:&quot;9d8b3c4c-b977-40ec-a186-349d876e526c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should sort category listings&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 24. GET /categories/:slug/listings - Get Listings by Category should sort category listings&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:113,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testCategorySlug) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/categories/${testCategorySlug}/listings?sort=price_low`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.listings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;abb3cdce-51b9-42ad-a823-1fc9036f45f0&quot;,&quot;parentUUID&quot;:&quot;9d8b3c4c-b977-40ec-a186-349d876e526c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0608090e-c20b-474f-b50c-a496fb010aaf&quot;,&quot;55dbe65a-2a2e-41ec-a633-a4ba5b94eebf&quot;,&quot;abb3cdce-51b9-42ad-a823-1fc9036f45f0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:337,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;407db995-90c6-4f1a-a28b-eaf0417f02e2&quot;,&quot;title&quot;:&quot;25. POST /categories/admin/create - Create Category&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\04-category.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\04-category.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a new category as admin&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 25. POST /categories/admin/create - Create Category should create a new category as admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const categoryData = {\n  category_name: `Test Category ${Date.now()}`,\n  slug: `test-category-${Date.now()}`,\n  description: &#x27;A test category for automated testing&#x27;,\n  icon_url: &#x27;https://example.com/icon.png&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/categories/admin/create`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send(categoryData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;category_id&#x27;);\ntestData.categoryIds.test1 = res.body.category_id;&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 201 but got 404&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 201 but got 404\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/04-category.test.js:136:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 201\n&quot;},&quot;uuid&quot;:&quot;0170108d-be0e-489e-9664-744c349279c3&quot;,&quot;parentUUID&quot;:&quot;407db995-90c6-4f1a-a28b-eaf0417f02e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category creation without authentication&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 25. POST /categories/admin/create - Create Category should reject category creation without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const categoryData = {\n  category_name: &#x27;Unauthorized Category&#x27;,\n  slug: &#x27;unauthorized-category&#x27;,\n  description: &#x27;Should not be created&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/categories/admin/create`)\n  .send(categoryData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 401 but got 404&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 401 but got 404\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/04-category.test.js:154:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 401\n&quot;},&quot;uuid&quot;:&quot;cd607759-3efa-47f3-8a43-f5377c047100&quot;,&quot;parentUUID&quot;:&quot;407db995-90c6-4f1a-a28b-eaf0417f02e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category creation by non-admin&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 25. POST /categories/admin/create - Create Category should reject category creation by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const categoryData = {\n  category_name: &#x27;Seller Category&#x27;,\n  slug: &#x27;seller-category&#x27;,\n  description: &#x27;Created by seller&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/categories/admin/create`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send(categoryData);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 403 but got 404&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 403 but got 404\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/04-category.test.js:170:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 403\n&quot;},&quot;uuid&quot;:&quot;39275e1a-1e06-4324-837a-1b7b680e2184&quot;,&quot;parentUUID&quot;:&quot;407db995-90c6-4f1a-a28b-eaf0417f02e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category with missing required fields&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 25. POST /categories/admin/create - Create Category should reject category with missing required fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const categoryData = {\n  category_name: &#x27;Incomplete Category&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/categories/admin/create`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send(categoryData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 400 but got 404&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 400 but got 404\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/04-category.test.js:184:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 400\n&quot;},&quot;uuid&quot;:&quot;523301ec-b919-42b6-b19f-e50bd152f297&quot;,&quot;parentUUID&quot;:&quot;407db995-90c6-4f1a-a28b-eaf0417f02e2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;0170108d-be0e-489e-9664-744c349279c3&quot;,&quot;cd607759-3efa-47f3-8a43-f5377c047100&quot;,&quot;39275e1a-1e06-4324-837a-1b7b680e2184&quot;,&quot;523301ec-b919-42b6-b19f-e50bd152f297&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;9f7111a4-5110-4537-bd36-2e34b18d7cf2&quot;,&quot;title&quot;:&quot;26. PUT /categories/admin/:id - Update Category&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\04-category.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\04-category.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should update category as admin&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 26. PUT /categories/admin/:id - Update Category should update category as admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testData.categoryIds.test1) {\n  this.skip();\n  return;\n}\nconst updateData = {\n  category_name: `Updated Category ${Date.now()}`,\n  description: &#x27;Updated description for testing&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/categories/admin/${testData.categoryIds.test1}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send(updateData);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;category&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/04-category.test.js:191:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;e142eaa8-8e84-4765-96ef-9479e50210ff&quot;,&quot;parentUUID&quot;:&quot;9f7111a4-5110-4537-bd36-2e34b18d7cf2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category update without authentication&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 26. PUT /categories/admin/:id - Update Category should reject category update without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testData.categoryIds.test1) {\n  this.skip();\n  return;\n}\nconst updateData = {\n  category_name: &#x27;Unauthorized Update&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/categories/admin/${testData.categoryIds.test1}`)\n  .send(updateData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/04-category.test.js:212:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;5128f746-d79a-475e-b682-7faf30052dd7&quot;,&quot;parentUUID&quot;:&quot;9f7111a4-5110-4537-bd36-2e34b18d7cf2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category update by non-admin&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 26. PUT /categories/admin/:id - Update Category should reject category update by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testData.categoryIds.test1) {\n  this.skip();\n  return;\n}\nconst updateData = {\n  category_name: &#x27;Seller Update&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/categories/admin/${testData.categoryIds.test1}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send(updateData);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/04-category.test.js:230:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;05cea75e-83f8-4517-b675-23b136f8f17c&quot;,&quot;parentUUID&quot;:&quot;9f7111a4-5110-4537-bd36-2e34b18d7cf2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;e142eaa8-8e84-4765-96ef-9479e50210ff&quot;,&quot;5128f746-d79a-475e-b682-7faf30052dd7&quot;,&quot;05cea75e-83f8-4517-b675-23b136f8f17c&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;42e75993-1d47-4959-b622-3ecccb7daa35&quot;,&quot;title&quot;:&quot;27. DELETE /categories/admin/:id - Delete Category&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\04-category.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\04-category.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;27. DELETE /categories/admin/:id - Delete Category\&quot;&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 27. DELETE /categories/admin/:id - Delete Category \&quot;before all\&quot; hook in \&quot;27. DELETE /categories/admin/:id - Delete Category\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Create a category to delete\nconst categoryData = {\n  category_name: `To Delete ${Date.now()}`,\n  slug: `to-delete-${Date.now()}`,\n  description: &#x27;This category will be deleted&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/categories/admin/create`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send(categoryData);\nif (res.body.success) {\n  categoryToDelete = res.body.category_id;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;60abd76b-cc24-48c6-8ef3-d8864a6af446&quot;,&quot;parentUUID&quot;:&quot;42e75993-1d47-4959-b622-3ecccb7daa35&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should delete category as admin&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 27. DELETE /categories/admin/:id - Delete Category should delete category as admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!categoryToDelete) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/categories/admin/${categoryToDelete}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`);\nvalidateSuccessResponse(res, 200);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/04-category.test.js:272:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;c16aad8d-cfab-4fcf-a80e-740b0f248c9e&quot;,&quot;parentUUID&quot;:&quot;42e75993-1d47-4959-b622-3ecccb7daa35&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category deletion without authentication&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 27. DELETE /categories/admin/:id - Delete Category should reject category deletion without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/categories/admin/999`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 401 but got 404&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 401 but got 404\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/04-category.test.js:289:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 401\n&quot;},&quot;uuid&quot;:&quot;e1117968-7504-4eca-82d3-78667b285ed2&quot;,&quot;parentUUID&quot;:&quot;42e75993-1d47-4959-b622-3ecccb7daa35&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category deletion by non-admin&quot;,&quot;fullTitle&quot;:&quot;Category Endpoints 27. DELETE /categories/admin/:id - Delete Category should reject category deletion by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/categories/admin/999`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 403 but got 404&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(34), …(2) } to have status code 403 but got 404\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/04-category.test.js:298:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 404\n+ 403\n&quot;},&quot;uuid&quot;:&quot;d2cc12ed-3ced-41a1-9cd8-3e6197cde861&quot;,&quot;parentUUID&quot;:&quot;42e75993-1d47-4959-b622-3ecccb7daa35&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;c16aad8d-cfab-4fcf-a80e-740b0f248c9e&quot;,&quot;e1117968-7504-4eca-82d3-78667b285ed2&quot;,&quot;d2cc12ed-3ced-41a1-9cd8-3e6197cde861&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;80d949cd-efc5-4f74-a4f4-f460b4356bea&quot;,&quot;title&quot;:&quot;Review Endpoints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\05-review.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\05-review.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Review Endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints \&quot;before all\&quot; hook in \&quot;Review Endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:112,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Get seller ID\nconst sellerRes = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signin`)\n  .send({\n    email: global.testAccounts.seller1.email,\n    password: global.testAccounts.seller1.password\n  });\nif (sellerRes.body.success) {\n  sellerId = sellerRes.body.user.user_id;\n}\n// Try to get an existing listing\nconst listingsRes = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings?limit=1`);\nif (listingsRes.body.success &amp;&amp; listingsRes.body.listings.length &gt; 0) {\n  testListingId = listingsRes.body.listings[0].listing_id;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c7638962-7d5a-44ad-bb35-84d9305e40ed&quot;,&quot;parentUUID&quot;:&quot;80d949cd-efc5-4f74-a4f4-f460b4356bea&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;640f9175-7640-4e2b-8968-c5864cf70e90&quot;,&quot;title&quot;:&quot;27. GET /reviews/seller/:sellerId - Get Seller Reviews&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\05-review.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\05-review.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get reviews for a seller&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 27. GET /reviews/seller/:sellerId - Get Seller Reviews should get reviews for a seller&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!sellerId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reviews/seller/${sellerId}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;reviews&#x27;);\nexpect(res.body.reviews).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:40:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;f266a373-1712-4e99-81bb-a4e1a15c5eb9&quot;,&quot;parentUUID&quot;:&quot;640f9175-7640-4e2b-8968-c5864cf70e90&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should paginate seller reviews&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 27. GET /reviews/seller/:sellerId - Get Seller Reviews should paginate seller reviews&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!sellerId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reviews/seller/${sellerId}?limit=5&amp;offset=0`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.reviews).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:55:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;285d5347-5234-4db3-8eea-329af4def7da&quot;,&quot;parentUUID&quot;:&quot;640f9175-7640-4e2b-8968-c5864cf70e90&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return empty array for seller with no reviews&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 27. GET /reviews/seller/:sellerId - Get Seller Reviews should return empty array for seller with no reviews&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:78,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reviews/seller/999999`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.reviews).to.be.an(&#x27;array&#x27;);\nexpect(res.body.reviews).to.have.length(0);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 500&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 500\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:72:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 500\n+ 200\n&quot;},&quot;uuid&quot;:&quot;b120179f-f82c-4f23-8cf3-9c55c792e212&quot;,&quot;parentUUID&quot;:&quot;640f9175-7640-4e2b-8968-c5864cf70e90&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;f266a373-1712-4e99-81bb-a4e1a15c5eb9&quot;,&quot;285d5347-5234-4db3-8eea-329af4def7da&quot;,&quot;b120179f-f82c-4f23-8cf3-9c55c792e212&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:79,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;350d0bcd-e783-474e-8b15-99f0d981b130&quot;,&quot;title&quot;:&quot;28. GET /reviews/listing/:listingId - Get Listing Reviews&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\05-review.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\05-review.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get reviews for a listing&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 28. GET /reviews/listing/:listingId - Get Listing Reviews should get reviews for a listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:421,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reviews/listing/${testListingId}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;reviews&#x27;);\nexpect(res.body.reviews).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { success: true, …(3) } to have property &#x27;reviews&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { success: true, …(3) } to have property &#x27;reviews&#x27;\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:90:32)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;ef2395a7-b79e-4b3f-a1a8-7cc85d5c0742&quot;,&quot;parentUUID&quot;:&quot;350d0bcd-e783-474e-8b15-99f0d981b130&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should paginate listing reviews&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 28. GET /reviews/listing/:listingId - Get Listing Reviews should paginate listing reviews&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:80,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reviews/listing/${testListingId}?limit=10&amp;offset=0`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.reviews).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected undefined to be an array&quot;,&quot;estack&quot;:&quot;AssertionError: expected undefined to be an array\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:105:38)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;48bbbe2d-5bda-404e-a462-e2e4bbfd0b0e&quot;,&quot;parentUUID&quot;:&quot;350d0bcd-e783-474e-8b15-99f0d981b130&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return empty array for listing with no reviews&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 28. GET /reviews/listing/:listingId - Get Listing Reviews should return empty array for listing with no reviews&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:70,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reviews/listing/999999`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.reviews).to.be.an(&#x27;array&#x27;);\nexpect(res.body.reviews).to.have.length(0);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected undefined to be an array&quot;,&quot;estack&quot;:&quot;AssertionError: expected undefined to be an array\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:114:38)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;64e9d18b-04f6-4e1a-8565-770ae1ee78cf&quot;,&quot;parentUUID&quot;:&quot;350d0bcd-e783-474e-8b15-99f0d981b130&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;ef2395a7-b79e-4b3f-a1a8-7cc85d5c0742&quot;,&quot;48bbbe2d-5bda-404e-a462-e2e4bbfd0b0e&quot;,&quot;64e9d18b-04f6-4e1a-8565-770ae1ee78cf&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:571,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;7e6bfbd4-458d-4083-9d0d-98ea80273d55&quot;,&quot;title&quot;:&quot;29. POST /reviews - Create Review&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\05-review.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\05-review.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a review for a listing&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 29. POST /reviews - Create Review should create a review for a listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst reviewData = {\n  listingId: testListingId,\n  rating: 5,\n  comment: &#x27;Excellent product! Highly recommended.&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/reviews`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(reviewData);\nif (res.status === 201) {\n  validateSuccessResponse(res, 201);\n  expect(res.body).to.have.property(&#x27;data&#x27;);\n  expect(res.body.data).to.have.property(&#x27;reviewId&#x27;);\n  testReviewId = res.body.data.reviewId;\n  testData.reviewIds.test1 = testReviewId;\n} else {\n  // Might fail if already reviewed\n  expect(res.status).to.be.oneOf([201, 400]);\n}&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 401 to be one of [ 201, 400 ]&quot;,&quot;estack&quot;:&quot;AssertionError: expected 401 to be one of [ 201, 400 ]\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:146:34)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;f5143fbf-37a7-4017-8abf-4ae1fefc6a31&quot;,&quot;parentUUID&quot;:&quot;7e6bfbd4-458d-4083-9d0d-98ea80273d55&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject review creation without authentication&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 29. POST /reviews - Create Review should reject review creation without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst reviewData = {\n  listingId: testListingId,\n  rating: 5,\n  comment: &#x27;Unauthorized review&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/reviews`)\n  .send(reviewData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d5b378c1-113a-45a6-b2bc-cd99d024f006&quot;,&quot;parentUUID&quot;:&quot;7e6bfbd4-458d-4083-9d0d-98ea80273d55&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject review with invalid rating&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 29. POST /reviews - Create Review should reject review with invalid rating&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst reviewData = {\n  listingId: testListingId,\n  rating: 6, // Invalid rating (should be 1-5)\n  comment: &#x27;Invalid rating test&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/reviews`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(reviewData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:188:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 400\n&quot;},&quot;uuid&quot;:&quot;9b806d2d-32f2-4978-a335-95e714512581&quot;,&quot;parentUUID&quot;:&quot;7e6bfbd4-458d-4083-9d0d-98ea80273d55&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject review with missing required fields&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 29. POST /reviews - Create Review should reject review with missing required fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const reviewData = {\n  rating: 5\n  // Missing listing_id\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/reviews`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(reviewData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:203:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 400\n&quot;},&quot;uuid&quot;:&quot;8d391fb0-c238-4044-88d3-8e02ff9c61ca&quot;,&quot;parentUUID&quot;:&quot;7e6bfbd4-458d-4083-9d0d-98ea80273d55&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d5b378c1-113a-45a6-b2bc-cd99d024f006&quot;],&quot;failures&quot;:[&quot;f5143fbf-37a7-4017-8abf-4ae1fefc6a31&quot;,&quot;9b806d2d-32f2-4978-a335-95e714512581&quot;,&quot;8d391fb0-c238-4044-88d3-8e02ff9c61ca&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;0c29633c-2f94-49fd-a94c-d54a227bb563&quot;,&quot;title&quot;:&quot;30. GET /reviews/check/:listingId - Check If User Reviewed&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\05-review.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\05-review.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should check if user has reviewed a listing&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 30. GET /reviews/check/:listingId - Check If User Reviewed should check if user has reviewed a listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reviews/check/${testListingId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;hasReviewed&#x27;);\nexpect(res.body.hasReviewed).to.be.a(&#x27;boolean&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { success: true, data: { …(2) } } to have property &#x27;message&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { success: true, data: { …(2) } } to have property &#x27;message&#x27;\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:88:28)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:219:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;fcb4546e-aa41-4161-a475-6d8fe79252eb&quot;,&quot;parentUUID&quot;:&quot;0c29633c-2f94-49fd-a94c-d54a227bb563&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject check without authentication&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 30. GET /reviews/check/:listingId - Check If User Reviewed should reject check without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reviews/check/${testListingId}`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 401 but got 200&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 401 but got 200\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:234:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 200\n+ 401\n&quot;},&quot;uuid&quot;:&quot;ba729354-c8a2-4ddb-b9f9-68aead5f5bbd&quot;,&quot;parentUUID&quot;:&quot;0c29633c-2f94-49fd-a94c-d54a227bb563&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;fcb4546e-aa41-4161-a475-6d8fe79252eb&quot;,&quot;ba729354-c8a2-4ddb-b9f9-68aead5f5bbd&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;d139ebcc-92af-4227-9cef-82cc8303c931&quot;,&quot;title&quot;:&quot;31. DELETE /reviews/:reviewId - Delete Review&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\05-review.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\05-review.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;31. DELETE /reviews/:reviewId - Delete Review\&quot;&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 31. DELETE /reviews/:reviewId - Delete Review \&quot;before all\&quot; hook in \&quot;31. DELETE /reviews/:reviewId - Delete Review\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Create a review to delete\nif (testListingId) {\n  const reviewData = {\n    listingId: testListingId,\n    rating: 4,\n    comment: &#x27;This review will be deleted for testing purposes&#x27;\n  };\n  const res = await chai\n    .request(baseURL)\n    .post(`${apiPrefix}/reviews`)\n    .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n    .send(reviewData);\n  if (res.body.success &amp;&amp; res.body.data) {\n    reviewToDelete = res.body.data.reviewId;\n  }\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;563aec64-b366-4445-93c0-2d41c3954a72&quot;,&quot;parentUUID&quot;:&quot;d139ebcc-92af-4227-9cef-82cc8303c931&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should delete own review&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 31. DELETE /reviews/:reviewId - Delete Review should delete own review&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!reviewToDelete) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/reviews/${reviewToDelete}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:264:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;5cdb3d89-7e48-42b8-a458-59e01e9be1bf&quot;,&quot;parentUUID&quot;:&quot;d139ebcc-92af-4227-9cef-82cc8303c931&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject review deletion without authentication&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 31. DELETE /reviews/:reviewId - Delete Review should reject review deletion without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/reviews/999`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1005f74a-7c2e-4866-8bbc-7ec2c3ebb4d6&quot;,&quot;parentUUID&quot;:&quot;d139ebcc-92af-4227-9cef-82cc8303c931&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for non-existent review&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 31. DELETE /reviews/:reviewId - Delete Review should return 404 for non-existent review&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/reviews/999999`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:290:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 404\n&quot;},&quot;uuid&quot;:&quot;e21c5377-2b1d-46dd-9ac5-91db960edc49&quot;,&quot;parentUUID&quot;:&quot;d139ebcc-92af-4227-9cef-82cc8303c931&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1005f74a-7c2e-4866-8bbc-7ec2c3ebb4d6&quot;],&quot;failures&quot;:[&quot;5cdb3d89-7e48-42b8-a458-59e01e9be1bf&quot;,&quot;e21c5377-2b1d-46dd-9ac5-91db960edc49&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;70fbf9f8-ce17-480d-842a-8a48009e234e&quot;,&quot;title&quot;:&quot;32. PATCH /reviews/:reviewId/spam - Mark Review as Spam&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\05-review.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\05-review.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should mark review as spam by admin&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 32. PATCH /reviews/:reviewId/spam - Mark Review as Spam should mark review as spam by admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testReviewId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/reviews/${testReviewId}/spam`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send({ isSpam: true });\nvalidateSuccessResponse(res, 200);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:297:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;a428409d-d77a-4dad-9f79-707cae9d9601&quot;,&quot;parentUUID&quot;:&quot;70fbf9f8-ce17-480d-842a-8a48009e234e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject spam marking without authentication&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 32. PATCH /reviews/:reviewId/spam - Mark Review as Spam should reject spam marking without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testReviewId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/reviews/${testReviewId}/spam`)\n  .send({ is_spam: true });\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:312:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;b1eaab3f-6bc0-4b71-8093-3ef01c6aec5c&quot;,&quot;parentUUID&quot;:&quot;70fbf9f8-ce17-480d-842a-8a48009e234e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject spam marking by non-admin&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 32. PATCH /reviews/:reviewId/spam - Mark Review as Spam should reject spam marking by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testReviewId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/reviews/${testReviewId}/spam`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send({ isSpam: true });\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:326:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;4e9cd3a4-a434-44de-bf67-4d56d806a2ba&quot;,&quot;parentUUID&quot;:&quot;70fbf9f8-ce17-480d-842a-8a48009e234e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should unmark review as spam&quot;,&quot;fullTitle&quot;:&quot;Review Endpoints 32. PATCH /reviews/:reviewId/spam - Mark Review as Spam should unmark review as spam&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testReviewId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/reviews/${testReviewId}/spam`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send({ isSpam: false });\nvalidateSuccessResponse(res, 200);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/05-review.test.js:341:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;929b1e8b-41c8-4a35-9ab0-8a9dfa290597&quot;,&quot;parentUUID&quot;:&quot;70fbf9f8-ce17-480d-842a-8a48009e234e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;a428409d-d77a-4dad-9f79-707cae9d9601&quot;,&quot;b1eaab3f-6bc0-4b71-8093-3ef01c6aec5c&quot;,&quot;4e9cd3a4-a434-44de-bf67-4d56d806a2ba&quot;,&quot;929b1e8b-41c8-4a35-9ab0-8a9dfa290597&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;a81d0e9f-2aa3-4dee-9339-093ef981f494&quot;,&quot;title&quot;:&quot;Saved Listing Endpoints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\06-saved-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\06-saved-listing.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Saved Listing Endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints \&quot;before all\&quot; hook in \&quot;Saved Listing Endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:73,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Get an existing listing to test with\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings?limit=1`);\nif (res.body.success &amp;&amp; res.body.listings.length &gt; 0) {\n  testListingId = res.body.listings[0].listing_id;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8578c12a-b772-42e1-830e-a2893fdf7535&quot;,&quot;parentUUID&quot;:&quot;a81d0e9f-2aa3-4dee-9339-093ef981f494&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;fe20685e-d184-4d4c-983b-5c445aceb834&quot;,&quot;title&quot;:&quot;33. POST /saved-listings - Save Listing&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\06-saved-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\06-saved-listing.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should save a listing&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 33. POST /saved-listings - Save Listing should save a listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/saved-listings`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send({ listingId: testListingId });\nif (res.status === 201) {\n  validateSuccessResponse(res, 201);\n  expect(res.body).to.have.property(&#x27;data&#x27;);\n  expect(res.body.data).to.have.property(&#x27;savedId&#x27;);\n} else if (res.status === 400) {\n  // Already saved\n  expect(res.body).to.have.property(&#x27;success&#x27;).that.equals(false);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fd584e7f-de05-4068-839d-34705e92dc41&quot;,&quot;parentUUID&quot;:&quot;fe20685e-d184-4d4c-983b-5c445aceb834&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject saving without authentication&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 33. POST /saved-listings - Save Listing should reject saving without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/saved-listings`)\n  .send({ listingId: testListingId });\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fd4461f1-b2eb-4352-bed6-927cccbfa2fe&quot;,&quot;parentUUID&quot;:&quot;fe20685e-d184-4d4c-983b-5c445aceb834&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject saving with missing listing_id&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 33. POST /saved-listings - Save Listing should reject saving with missing listing_id&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/saved-listings`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send({});\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/06-saved-listing.test.js:66:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 400\n&quot;},&quot;uuid&quot;:&quot;f781b97b-3ce8-4465-84ab-faca9aa55e27&quot;,&quot;parentUUID&quot;:&quot;fe20685e-d184-4d4c-983b-5c445aceb834&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject saving non-existent listing&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 33. POST /saved-listings - Save Listing should reject saving non-existent listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/saved-listings`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send({ listing_id: 999999 });\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/06-saved-listing.test.js:76:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 404\n&quot;},&quot;uuid&quot;:&quot;146cd8c5-416e-464c-ae76-e2c8bd0118ec&quot;,&quot;parentUUID&quot;:&quot;fe20685e-d184-4d4c-983b-5c445aceb834&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fd584e7f-de05-4068-839d-34705e92dc41&quot;,&quot;fd4461f1-b2eb-4352-bed6-927cccbfa2fe&quot;],&quot;failures&quot;:[&quot;f781b97b-3ce8-4465-84ab-faca9aa55e27&quot;,&quot;146cd8c5-416e-464c-ae76-e2c8bd0118ec&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;7adb2947-f453-41ce-ae23-e6e0141ddf04&quot;,&quot;title&quot;:&quot;34. DELETE /saved-listings/:listingId - Unsave Listing&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\06-saved-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\06-saved-listing.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;34. DELETE /saved-listings/:listingId - Unsave Listing\&quot;&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 34. DELETE /saved-listings/:listingId - Unsave Listing \&quot;before all\&quot; hook in \&quot;34. DELETE /saved-listings/:listingId - Unsave Listing\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Ensure the listing is saved before trying to unsave\nif (testListingId) {\n  await chai\n    .request(baseURL)\n    .post(`${apiPrefix}/saved-listings`)\n    .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n    .send({ listingId: testListingId });\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;35bd1fd5-d439-40e6-84c1-2e27cd0ec3d5&quot;,&quot;parentUUID&quot;:&quot;7adb2947-f453-41ce-ae23-e6e0141ddf04&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should unsave a listing&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 34. DELETE /saved-listings/:listingId - Unsave Listing should unsave a listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/saved-listings/${testListingId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/06-saved-listing.test.js:103:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;1e15c2f3-442a-4e92-8a6a-466310e4c682&quot;,&quot;parentUUID&quot;:&quot;7adb2947-f453-41ce-ae23-e6e0141ddf04&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject unsaving without authentication&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 34. DELETE /saved-listings/:listingId - Unsave Listing should reject unsaving without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/saved-listings/${testListingId}`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7833fc8b-cae5-4405-9300-0beffcb89877&quot;,&quot;parentUUID&quot;:&quot;7adb2947-f453-41ce-ae23-e6e0141ddf04&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for unsaving non-saved listing&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 34. DELETE /saved-listings/:listingId - Unsave Listing should return 404 for unsaving non-saved listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/saved-listings/999999`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/06-saved-listing.test.js:125:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 404\n&quot;},&quot;uuid&quot;:&quot;9a086d04-f2f4-47a2-9d38-633716e5f59e&quot;,&quot;parentUUID&quot;:&quot;7adb2947-f453-41ce-ae23-e6e0141ddf04&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7833fc8b-cae5-4405-9300-0beffcb89877&quot;],&quot;failures&quot;:[&quot;1e15c2f3-442a-4e92-8a6a-466310e4c682&quot;,&quot;9a086d04-f2f4-47a2-9d38-633716e5f59e&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;f6f6a31d-b5a4-473b-8def-0282f047d543&quot;,&quot;title&quot;:&quot;35. GET /saved-listings - Get Saved Listings&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\06-saved-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\06-saved-listing.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;35. GET /saved-listings - Get Saved Listings\&quot;&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 35. GET /saved-listings - Get Saved Listings \&quot;before all\&quot; hook in \&quot;35. GET /saved-listings - Get Saved Listings\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Save a listing for testing\nif (testListingId) {\n  await chai\n    .request(baseURL)\n    .post(`${apiPrefix}/saved-listings`)\n    .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n    .send({ listingId: testListingId });\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d201a481-7438-4908-bf79-e39c875dbdcc&quot;,&quot;parentUUID&quot;:&quot;f6f6a31d-b5a4-473b-8def-0282f047d543&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get user&#x27;s saved listings&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 35. GET /saved-listings - Get Saved Listings should get user&#x27;s saved listings&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/saved-listings`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;savedListings&#x27;);\nexpect(res.body.savedListings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/06-saved-listing.test.js:147:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;e0ac19a1-a689-4ddc-89eb-3a391e983d67&quot;,&quot;parentUUID&quot;:&quot;f6f6a31d-b5a4-473b-8def-0282f047d543&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should paginate saved listings&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 35. GET /saved-listings - Get Saved Listings should paginate saved listings&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/saved-listings?limit=5&amp;offset=0`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.savedListings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/06-saved-listing.test.js:158:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;c301f9d5-6717-4564-9e81-d74267ce2a9b&quot;,&quot;parentUUID&quot;:&quot;f6f6a31d-b5a4-473b-8def-0282f047d543&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting saved listings without authentication&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 35. GET /saved-listings - Get Saved Listings should reject getting saved listings without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/saved-listings`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7176a6cc-7f70-4a20-8210-0468c8fc16b4&quot;,&quot;parentUUID&quot;:&quot;f6f6a31d-b5a4-473b-8def-0282f047d543&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return empty array for user with no saved listings&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 35. GET /saved-listings - Get Saved Listings should return empty array for user with no saved listings&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/saved-listings`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.savedListings).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/06-saved-listing.test.js:176:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;4acb0a82-c43a-48b5-8f08-6ec7cadb80ee&quot;,&quot;parentUUID&quot;:&quot;f6f6a31d-b5a4-473b-8def-0282f047d543&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7176a6cc-7f70-4a20-8210-0468c8fc16b4&quot;],&quot;failures&quot;:[&quot;e0ac19a1-a689-4ddc-89eb-3a391e983d67&quot;,&quot;c301f9d5-6717-4564-9e81-d74267ce2a9b&quot;,&quot;4acb0a82-c43a-48b5-8f08-6ec7cadb80ee&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;6fe7d118-5813-4e8d-98f0-64889e8f7f99&quot;,&quot;title&quot;:&quot;36. GET /saved-listings/check/:listingId - Check If Listing is Saved&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\06-saved-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\06-saved-listing.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should check if listing is saved&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 36. GET /saved-listings/check/:listingId - Check If Listing is Saved should check if listing is saved&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/saved-listings/check/${testListingId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;isSaved&#x27;);\nexpect(res.body.isSaved).to.be.a(&#x27;boolean&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/06-saved-listing.test.js:193:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;4dc99d24-17c7-441e-95c2-f8639c919ebe&quot;,&quot;parentUUID&quot;:&quot;6fe7d118-5813-4e8d-98f0-64889e8f7f99&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject check without authentication&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 36. GET /saved-listings/check/:listingId - Check If Listing is Saved should reject check without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/saved-listings/check/${testListingId}`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99bbb15e-bb5b-4002-b793-548e82b42ee1&quot;,&quot;parentUUID&quot;:&quot;6fe7d118-5813-4e8d-98f0-64889e8f7f99&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return false for non-saved listing&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 36. GET /saved-listings/check/:listingId - Check If Listing is Saved should return false for non-saved listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/saved-listings/check/999999`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.isSaved).to.equal(false);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/06-saved-listing.test.js:217:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;1d857a5a-b36f-4b05-b0cf-f1720094a3b5&quot;,&quot;parentUUID&quot;:&quot;6fe7d118-5813-4e8d-98f0-64889e8f7f99&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;99bbb15e-bb5b-4002-b793-548e82b42ee1&quot;],&quot;failures&quot;:[&quot;4dc99d24-17c7-441e-95c2-f8639c919ebe&quot;,&quot;1d857a5a-b36f-4b05-b0cf-f1720094a3b5&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;a63218b7-b02c-455b-8002-8a3e70827ab2&quot;,&quot;title&quot;:&quot;37. GET /saved-listings/count/:listingId - Get Save Count&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\06-saved-listing.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\06-saved-listing.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get save count for a listing&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 37. GET /saved-listings/count/:listingId - Get Save Count should get save count for a listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:37,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/saved-listings/count/${testListingId}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;saveCount&#x27;);\nexpect(res.body.saveCount).to.be.a(&#x27;number&#x27;);\nexpect(res.body.saveCount).to.be.at.least(0);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { success: true, data: { …(2) } } to have property &#x27;message&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { success: true, data: { …(2) } } to have property &#x27;message&#x27;\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:88:28)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/06-saved-listing.test.js:233:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;35533c92-55b7-48a5-8ed1-dbd4b6e99942&quot;,&quot;parentUUID&quot;:&quot;a63218b7-b02c-455b-8002-8a3e70827ab2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 0 for listing with no saves&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 37. GET /saved-listings/count/:listingId - Get Save Count should return 0 for listing with no saves&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:36,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/saved-listings/count/999999`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.saveCount).to.equal(0);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { success: true, data: { …(2) } } to have property &#x27;message&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { success: true, data: { …(2) } } to have property &#x27;message&#x27;\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:88:28)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/06-saved-listing.test.js:244:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;3e327c99-0e10-41ac-8fa7-d28314f7717e&quot;,&quot;parentUUID&quot;:&quot;a63218b7-b02c-455b-8002-8a3e70827ab2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should work without authentication (public endpoint)&quot;,&quot;fullTitle&quot;:&quot;Saved Listing Endpoints 37. GET /saved-listings/count/:listingId - Get Save Count should work without authentication (public endpoint)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:36,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/saved-listings/count/${testListingId}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;saveCount&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { success: true, data: { …(2) } } to have property &#x27;message&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { success: true, data: { …(2) } } to have property &#x27;message&#x27;\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:88:28)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/06-saved-listing.test.js:258:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;81b351e1-2c92-462e-bfea-5beab37df0f1&quot;,&quot;parentUUID&quot;:&quot;a63218b7-b02c-455b-8002-8a3e70827ab2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;35533c92-55b7-48a5-8ed1-dbd4b6e99942&quot;,&quot;3e327c99-0e10-41ac-8fa7-d28314f7717e&quot;,&quot;81b351e1-2c92-462e-bfea-5beab37df0f1&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:109,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;a1ab0420-cc8c-4fc8-a197-a317b0cfcffb&quot;,&quot;title&quot;:&quot;Report Endpoints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\07-report.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\07-report.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Report Endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints \&quot;before all\&quot; hook in \&quot;Report Endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:72,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Get an existing listing to report\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings?limit=1`);\nif (res.body.success &amp;&amp; res.body.listings.length &gt; 0) {\n  testListingId = res.body.listings[0].listing_id;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fe988358-c051-40cc-84ab-3c54838fdb5e&quot;,&quot;parentUUID&quot;:&quot;a1ab0420-cc8c-4fc8-a197-a317b0cfcffb&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;fb96cb0c-784e-4dfb-876b-f8a6dc15b767&quot;,&quot;title&quot;:&quot;38. POST /reports - Submit Report&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\07-report.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\07-report.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should submit a listing report&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 38. POST /reports - Submit Report should submit a listing report&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:72,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst reportData = {\n  reportedType: &#x27;listing&#x27;,\n  reportedId: testListingId,\n  reason: &#x27;This is a spam listing for testing purposes&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/reports`)\n  .send(reportData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;data&#x27;);\nexpect(res.body.data).to.have.property(&#x27;reportId&#x27;);\ntestReportId = res.body.data.reportId;\ntestData.reportIds.test1 = testReportId;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d38d34f2-52e2-4a39-8a2b-0580c00c3685&quot;,&quot;parentUUID&quot;:&quot;fb96cb0c-784e-4dfb-876b-f8a6dc15b767&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should submit a report with authentication&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 38. POST /reports - Submit Report should submit a report with authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst reportData = {\n  report_type: &#x27;listing&#x27;,\n  reported_id: testListingId,\n  reason: &#x27;inappropriate&#x27;,\n  description: &#x27;Inappropriate content test report&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/reports`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(reportData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;report_id&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:68:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 201\n&quot;},&quot;uuid&quot;:&quot;a104f07d-1424-484b-b450-33aa8894071d&quot;,&quot;parentUUID&quot;:&quot;fb96cb0c-784e-4dfb-876b-f8a6dc15b767&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject report with missing required fields&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 38. POST /reports - Submit Report should reject report with missing required fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const reportData = {\n  report_type: &#x27;listing&#x27;\n  // Missing reported_id, reason\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/reports`)\n  .send(reportData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;db9bf050-4f03-4654-9455-4036dcf701f3&quot;,&quot;parentUUID&quot;:&quot;fb96cb0c-784e-4dfb-876b-f8a6dc15b767&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject report with invalid report_type&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 38. POST /reports - Submit Report should reject report with invalid report_type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const reportData = {\n  report_type: &#x27;invalid_type&#x27;,\n  reported_id: 1,\n  reason: &#x27;spam&#x27;,\n  description: &#x27;Test&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/reports`)\n  .send(reportData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b005877-e704-4eea-b26c-72b93c92cf55&quot;,&quot;parentUUID&quot;:&quot;fb96cb0c-784e-4dfb-876b-f8a6dc15b767&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d38d34f2-52e2-4a39-8a2b-0580c00c3685&quot;,&quot;db9bf050-4f03-4654-9455-4036dcf701f3&quot;,&quot;0b005877-e704-4eea-b26c-72b93c92cf55&quot;],&quot;failures&quot;:[&quot;a104f07d-1424-484b-b450-33aa8894071d&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:77,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;33ee1b86-f33d-4cb4-a8df-9560091cc263&quot;,&quot;title&quot;:&quot;39. GET /reports - Get All Reports&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\07-report.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\07-report.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get all reports as admin&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 39. GET /reports - Get All Reports should get all reports as admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;reports&#x27;);\nexpect(res.body.reports).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:110:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;ccb4a0ef-d5e8-4576-b73d-8bcfb3d8e862&quot;,&quot;parentUUID&quot;:&quot;33ee1b86-f33d-4cb4-a8df-9560091cc263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should filter reports by type&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 39. GET /reports - Get All Reports should filter reports by type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports?type=listing`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.reports).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:121:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;5065162c-131c-4d85-b6cb-6a9d5c284131&quot;,&quot;parentUUID&quot;:&quot;33ee1b86-f33d-4cb4-a8df-9560091cc263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should filter reports by status&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 39. GET /reports - Get All Reports should filter reports by status&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports?status=pending`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.reports).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:131:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;68bed1a1-5bee-4a27-aaf8-0e1e3da01bb6&quot;,&quot;parentUUID&quot;:&quot;33ee1b86-f33d-4cb4-a8df-9560091cc263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should paginate reports&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 39. GET /reports - Get All Reports should paginate reports&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports?limit=10&amp;offset=0`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.reports).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:141:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;03db394a-3d38-46c3-a3eb-5832febafdeb&quot;,&quot;parentUUID&quot;:&quot;33ee1b86-f33d-4cb4-a8df-9560091cc263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting reports without authentication&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 39. GET /reports - Get All Reports should reject getting reports without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;715a51f0-7bcf-4369-8332-4a2dbb274aa7&quot;,&quot;parentUUID&quot;:&quot;33ee1b86-f33d-4cb4-a8df-9560091cc263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting reports by non-admin&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 39. GET /reports - Get All Reports should reject getting reports by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:159:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;f07ab6b9-8969-41c6-8010-e82e2ba77f37&quot;,&quot;parentUUID&quot;:&quot;33ee1b86-f33d-4cb4-a8df-9560091cc263&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;715a51f0-7bcf-4369-8332-4a2dbb274aa7&quot;],&quot;failures&quot;:[&quot;ccb4a0ef-d5e8-4576-b73d-8bcfb3d8e862&quot;,&quot;5065162c-131c-4d85-b6cb-6a9d5c284131&quot;,&quot;68bed1a1-5bee-4a27-aaf8-0e1e3da01bb6&quot;,&quot;03db394a-3d38-46c3-a3eb-5832febafdeb&quot;,&quot;f07ab6b9-8969-41c6-8010-e82e2ba77f37&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;b3df844b-4db6-423d-ac4b-82fad005bec0&quot;,&quot;title&quot;:&quot;40. GET /reports/:reportId - Get Report Details&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\07-report.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\07-report.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get report details as admin&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 40. GET /reports/:reportId - Get Report Details should get report details as admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testReportId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports/${testReportId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;report&#x27;);\nexpect(res.body.report).to.have.property(&#x27;report_id&#x27;).that.equals(testReportId);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:175:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;4310ef1f-92bc-4197-9c49-87d327a9b6a0&quot;,&quot;parentUUID&quot;:&quot;b3df844b-4db6-423d-ac4b-82fad005bec0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting report details without authentication&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 40. GET /reports/:reportId - Get Report Details should reject getting report details without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testReportId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports/${testReportId}`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ae32943a-8a54-4458-a771-e90522283e27&quot;,&quot;parentUUID&quot;:&quot;b3df844b-4db6-423d-ac4b-82fad005bec0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting report details by non-admin&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 40. GET /reports/:reportId - Get Report Details should reject getting report details by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testReportId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports/${testReportId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:204:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;3990d723-e053-4e84-a417-3f172d7a6eec&quot;,&quot;parentUUID&quot;:&quot;b3df844b-4db6-423d-ac4b-82fad005bec0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for non-existent report&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 40. GET /reports/:reportId - Get Report Details should return 404 for non-existent report&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports/999999`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`);\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:213:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 404\n&quot;},&quot;uuid&quot;:&quot;45453c39-572d-4858-abd1-61a5f618a9cc&quot;,&quot;parentUUID&quot;:&quot;b3df844b-4db6-423d-ac4b-82fad005bec0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ae32943a-8a54-4458-a771-e90522283e27&quot;],&quot;failures&quot;:[&quot;4310ef1f-92bc-4197-9c49-87d327a9b6a0&quot;,&quot;3990d723-e053-4e84-a417-3f172d7a6eec&quot;,&quot;45453c39-572d-4858-abd1-61a5f618a9cc&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;a4f78191-464f-415a-a6bf-a0eea37a5735&quot;,&quot;title&quot;:&quot;41. GET /reports/statistics - Get Report Statistics&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\07-report.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\07-report.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get report statistics as admin&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 41. GET /reports/statistics - Get Report Statistics should get report statistics as admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports/statistics`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;statistics&#x27;);\nexpect(res.body.statistics).to.be.an(&#x27;object&#x27;);\nexpect(res.body.statistics).to.have.property(&#x27;total_reports&#x27;);\nexpect(res.body.statistics).to.have.property(&#x27;pending_reports&#x27;);\nexpect(res.body.statistics).to.have.property(&#x27;resolved_reports&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:224:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;7a1fef92-46e5-4f2d-92a7-b9ebdd65a436&quot;,&quot;parentUUID&quot;:&quot;a4f78191-464f-415a-a6bf-a0eea37a5735&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting statistics without authentication&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 41. GET /reports/statistics - Get Report Statistics should reject getting statistics without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports/statistics`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;55806407-e04b-4c55-a572-9c77c9fcbdfe&quot;,&quot;parentUUID&quot;:&quot;a4f78191-464f-415a-a6bf-a0eea37a5735&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting statistics by non-admin&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 41. GET /reports/statistics - Get Report Statistics should reject getting statistics by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/reports/statistics`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:246:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;6b0413db-bdfa-4c72-a799-a3e6a6c143f2&quot;,&quot;parentUUID&quot;:&quot;a4f78191-464f-415a-a6bf-a0eea37a5735&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;55806407-e04b-4c55-a572-9c77c9fcbdfe&quot;],&quot;failures&quot;:[&quot;7a1fef92-46e5-4f2d-92a7-b9ebdd65a436&quot;,&quot;6b0413db-bdfa-4c72-a799-a3e6a6c143f2&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;d3091c97-041d-4bac-8b23-a17d37acdb2b&quot;,&quot;title&quot;:&quot;42. PATCH /reports/:reportId/status - Update Report Status&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\07-report.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\07-report.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should update report status to reviewing&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 42. PATCH /reports/:reportId/status - Update Report Status should update report status to reviewing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testReportId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/reports/${testReportId}/status`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send({\n    status: &#x27;reviewing&#x27;,\n    admin_notes: &#x27;Under review for testing&#x27;\n  });\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;report&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:266:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;300bed24-a356-4f5b-b600-ea5e552eca2c&quot;,&quot;parentUUID&quot;:&quot;d3091c97-041d-4bac-8b23-a17d37acdb2b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should update report status to resolved&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 42. PATCH /reports/:reportId/status - Update Report Status should update report status to resolved&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testReportId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/reports/${testReportId}/status`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send({\n    status: &#x27;resolved&#x27;,\n    admin_notes: &#x27;Report resolved successfully&#x27;\n  });\nvalidateSuccessResponse(res, 200);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:285:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;cfd6eeb5-8dfd-4c2f-b341-7f850e006cd8&quot;,&quot;parentUUID&quot;:&quot;d3091c97-041d-4bac-8b23-a17d37acdb2b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject status update with invalid status&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 42. PATCH /reports/:reportId/status - Update Report Status should reject status update with invalid status&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testReportId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/reports/${testReportId}/status`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send({\n    status: &#x27;invalid_status&#x27;\n  });\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:302:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 400\n&quot;},&quot;uuid&quot;:&quot;498ae062-e1f8-4377-aa82-e4519ce23377&quot;,&quot;parentUUID&quot;:&quot;d3091c97-041d-4bac-8b23-a17d37acdb2b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject status update without authentication&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 42. PATCH /reports/:reportId/status - Update Report Status should reject status update without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testReportId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/reports/${testReportId}/status`)\n  .send({\n    status: &#x27;resolved&#x27;\n  });\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dccfb6c4-5b27-494a-b54f-33e99be82b87&quot;,&quot;parentUUID&quot;:&quot;d3091c97-041d-4bac-8b23-a17d37acdb2b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject status update by non-admin&quot;,&quot;fullTitle&quot;:&quot;Report Endpoints 42. PATCH /reports/:reportId/status - Update Report Status should reject status update by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testReportId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/reports/${testReportId}/status`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send({\n    status: &#x27;resolved&#x27;\n  });\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/07-report.test.js:335:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;884295d0-5cae-4268-b709-168bdb60768a&quot;,&quot;parentUUID&quot;:&quot;d3091c97-041d-4bac-8b23-a17d37acdb2b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;dccfb6c4-5b27-494a-b54f-33e99be82b87&quot;],&quot;failures&quot;:[&quot;300bed24-a356-4f5b-b600-ea5e552eca2c&quot;,&quot;cfd6eeb5-8dfd-4c2f-b341-7f850e006cd8&quot;,&quot;498ae062-e1f8-4377-aa82-e4519ce23377&quot;,&quot;884295d0-5cae-4268-b709-168bdb60768a&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;b7367acb-ed81-418e-9b33-812ae5f2db4c&quot;,&quot;title&quot;:&quot;Conversation (Messaging) Endpoints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\08-conversation.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\08-conversation.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Conversation (Messaging) Endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints \&quot;before all\&quot; hook in \&quot;Conversation (Messaging) Endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:113,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Get seller ID\nconst sellerRes = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signin`)\n  .send({\n    email: global.testAccounts.seller1.email,\n    password: global.testAccounts.seller1.password\n  });\nif (sellerRes.body.success) {\n  sellerId = sellerRes.body.user.user_id;\n}\n// Get a listing\nconst listingsRes = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings?limit=1`);\nif (listingsRes.body.success &amp;&amp; listingsRes.body.listings.length &gt; 0) {\n  testListingId = listingsRes.body.listings[0].listing_id;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3c8ea1ac-9d71-4668-bcad-e6117b3872b2&quot;,&quot;parentUUID&quot;:&quot;b7367acb-ed81-418e-9b33-812ae5f2db4c&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;c5937479-ba24-4b1c-9740-366d83bdf00d&quot;,&quot;title&quot;:&quot;43. POST /conversations - Create or Get Conversation&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\08-conversation.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\08-conversation.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a new conversation&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 43. POST /conversations - Create or Get Conversation should create a new conversation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId || !sellerId) {\n  this.skip();\n  return;\n}\nconst conversationData = {\n  listing_id: testListingId,\n  seller_id: sellerId,\n  initial_message: &#x27;Hello, I am interested in this item. Is it still available?&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/conversations`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(conversationData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;conversation_id&#x27;);\nexpect(res.body).to.have.property(&#x27;message&#x27;);\ntestConversationId = res.body.conversation_id;\ntestData.conversationIds.test1 = testConversationId;&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:40:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;ac0bdaba-b213-4498-8fbd-242de54d923d&quot;,&quot;parentUUID&quot;:&quot;c5937479-ba24-4b1c-9740-366d83bdf00d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should get existing conversation instead of creating duplicate&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 43. POST /conversations - Create or Get Conversation should get existing conversation instead of creating duplicate&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId || !sellerId) {\n  this.skip();\n  return;\n}\nconst conversationData = {\n  listing_id: testListingId,\n  seller_id: sellerId,\n  initial_message: &#x27;Follow up message&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/conversations`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(conversationData);\n// Should return 200 with existing conversation\nexpect(res.status).to.be.oneOf([200, 201]);\nexpect(res.body).to.have.property(&#x27;conversation_id&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:66:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;742688c9-03af-4805-9b28-2a770fc93ce0&quot;,&quot;parentUUID&quot;:&quot;c5937479-ba24-4b1c-9740-366d83bdf00d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject conversation creation without authentication&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 43. POST /conversations - Create or Get Conversation should reject conversation creation without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId || !sellerId) {\n  this.skip();\n  return;\n}\nconst conversationData = {\n  listing_id: testListingId,\n  seller_id: sellerId,\n  initial_message: &#x27;Unauthorized message&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/conversations`)\n  .send(conversationData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:89:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;5ee04658-f854-4ed2-b9f8-e2e935201c89&quot;,&quot;parentUUID&quot;:&quot;c5937479-ba24-4b1c-9740-366d83bdf00d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject conversation with missing required fields&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 43. POST /conversations - Create or Get Conversation should reject conversation with missing required fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const conversationData = {\n  initial_message: &#x27;Missing fields&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/conversations`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(conversationData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:118:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 400\n&quot;},&quot;uuid&quot;:&quot;6192d479-d012-40c8-88c2-7f2d45a7c513&quot;,&quot;parentUUID&quot;:&quot;c5937479-ba24-4b1c-9740-366d83bdf00d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;ac0bdaba-b213-4498-8fbd-242de54d923d&quot;,&quot;742688c9-03af-4805-9b28-2a770fc93ce0&quot;,&quot;5ee04658-f854-4ed2-b9f8-e2e935201c89&quot;,&quot;6192d479-d012-40c8-88c2-7f2d45a7c513&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;d6b812f3-2614-4b13-9b4c-c0ba17d9e1d2&quot;,&quot;title&quot;:&quot;44. GET /conversations - Get User Conversations&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\08-conversation.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\08-conversation.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get user&#x27;s conversations&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 44. GET /conversations - Get User Conversations should get user&#x27;s conversations&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/conversations`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;conversations&#x27;);\nexpect(res.body.conversations).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:129:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;5a7ea507-7e92-4134-aa17-87ad6fc7b2a6&quot;,&quot;parentUUID&quot;:&quot;d6b812f3-2614-4b13-9b4c-c0ba17d9e1d2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should paginate conversations&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 44. GET /conversations - Get User Conversations should paginate conversations&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/conversations?limit=10&amp;offset=0`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.conversations).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:140:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;48552b25-c22c-4e31-8ec8-6ac17cce46b1&quot;,&quot;parentUUID&quot;:&quot;d6b812f3-2614-4b13-9b4c-c0ba17d9e1d2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting conversations without authentication&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 44. GET /conversations - Get User Conversations should reject getting conversations without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/conversations`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4e547ff9-39b4-403a-89a5-f9cdbae64560&quot;,&quot;parentUUID&quot;:&quot;d6b812f3-2614-4b13-9b4c-c0ba17d9e1d2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return empty array for user with no conversations&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 44. GET /conversations - Get User Conversations should return empty array for user with no conversations&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:309,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Create a new user without conversations\nconst newUserData = {\n  email: `noconv_${Date.now()}@example.com`,\n  password: &#x27;password123&#x27;,\n  username: `noconv_${Date.now()}`,\n  first_name: &#x27;No&#x27;,\n  last_name: &#x27;Conversation&#x27;,\n  role: &#x27;buyer&#x27;\n};\nconst signupRes = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signup`)\n  .send(newUserData);\nif (signupRes.body.success) {\n  const signinRes = await chai\n    .request(baseURL)\n    .post(`${apiPrefix}/users/signin`)\n    .send({\n      email: newUserData.email,\n      password: newUserData.password\n    });\n  if (signinRes.body.success) {\n    const res = await chai\n      .request(baseURL)\n      .get(`${apiPrefix}/conversations`)\n      .set(&#x27;Authorization&#x27;, `Bearer ${signinRes.body.token}`);\n    validateSuccessResponse(res, 200);\n    expect(res.body.conversations).to.be.an(&#x27;array&#x27;);\n    expect(res.body.conversations).to.have.length(0);\n  }\n}&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected undefined to be an array&quot;,&quot;estack&quot;:&quot;AssertionError: expected undefined to be an array\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:184:48)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;0c00830b-1129-4539-ba0b-630f8b66662e&quot;,&quot;parentUUID&quot;:&quot;d6b812f3-2614-4b13-9b4c-c0ba17d9e1d2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4e547ff9-39b4-403a-89a5-f9cdbae64560&quot;],&quot;failures&quot;:[&quot;5a7ea507-7e92-4134-aa17-87ad6fc7b2a6&quot;,&quot;48552b25-c22c-4e31-8ec8-6ac17cce46b1&quot;,&quot;0c00830b-1129-4539-ba0b-630f8b66662e&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:315,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;d21b93a2-88e4-475b-9f91-8fff5653e75a&quot;,&quot;title&quot;:&quot;45. GET /conversations/unread-count - Get Unread Message Count&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\08-conversation.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\08-conversation.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get unread message count&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 45. GET /conversations/unread-count - Get Unread Message Count should get unread message count&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/conversations/unread-count`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;unreadCount&#x27;);\nexpect(res.body.unreadCount).to.be.a(&#x27;number&#x27;);\nexpect(res.body.unreadCount).to.be.at.least(0);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:198:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;efb1dbf8-e93d-48ea-8b2a-0887d8d28e9f&quot;,&quot;parentUUID&quot;:&quot;d21b93a2-88e4-475b-9f91-8fff5653e75a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting unread count without authentication&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 45. GET /conversations/unread-count - Get Unread Message Count should reject getting unread count without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/conversations/unread-count`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;58eba52c-948a-4fbe-94de-93586cfc972b&quot;,&quot;parentUUID&quot;:&quot;d21b93a2-88e4-475b-9f91-8fff5653e75a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;58eba52c-948a-4fbe-94de-93586cfc972b&quot;],&quot;failures&quot;:[&quot;efb1dbf8-e93d-48ea-8b2a-0887d8d28e9f&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;9565b161-ccd3-47a2-aaba-4bad44de01f2&quot;,&quot;title&quot;:&quot;46. GET /conversations/:conversationId/messages - Get Conversation Messages&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\08-conversation.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\08-conversation.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get messages from a conversation&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 46. GET /conversations/:conversationId/messages - Get Conversation Messages should get messages from a conversation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testConversationId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/conversations/${testConversationId}/messages`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;messages&#x27;);\nexpect(res.body.messages).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:216:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;47907798-933e-4ac5-81b3-63a9a1dc3719&quot;,&quot;parentUUID&quot;:&quot;9565b161-ccd3-47a2-aaba-4bad44de01f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should paginate conversation messages&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 46. GET /conversations/:conversationId/messages - Get Conversation Messages should paginate conversation messages&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testConversationId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/conversations/${testConversationId}/messages?limit=50&amp;offset=0`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.messages).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:232:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;a7681b69-f542-4175-a83d-7f6fda76cc78&quot;,&quot;parentUUID&quot;:&quot;9565b161-ccd3-47a2-aaba-4bad44de01f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting messages without authentication&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 46. GET /conversations/:conversationId/messages - Get Conversation Messages should reject getting messages without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testConversationId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/conversations/${testConversationId}/messages`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:247:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;d518d115-2046-4fc2-a852-079b65ce47f7&quot;,&quot;parentUUID&quot;:&quot;9565b161-ccd3-47a2-aaba-4bad44de01f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting messages from conversation user is not part of&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 46. GET /conversations/:conversationId/messages - Get Conversation Messages should reject getting messages from conversation user is not part of&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testConversationId) {\n  this.skip();\n  return;\n}\n// Create a new user who is not part of the conversation\nconst newUserData = {\n  email: `outsider_${Date.now()}@example.com`,\n  password: &#x27;password123&#x27;,\n  username: `outsider_${Date.now()}`,\n  first_name: &#x27;Outsider&#x27;,\n  last_name: &#x27;User&#x27;,\n  role: &#x27;buyer&#x27;\n};\nconst signupRes = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signup`)\n  .send(newUserData);\nif (signupRes.body.success) {\n  const signinRes = await chai\n    .request(baseURL)\n    .post(`${apiPrefix}/users/signin`)\n    .send({\n      email: newUserData.email,\n      password: newUserData.password\n    });\n  if (signinRes.body.success) {\n    const res = await chai\n      .request(baseURL)\n      .get(`${apiPrefix}/conversations/${testConversationId}/messages`)\n      .set(&#x27;Authorization&#x27;, `Bearer ${signinRes.body.token}`);\n    validateErrorResponse(res, 403);\n  }\n}&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:260:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;1c57f0d6-c108-4122-9745-17d7fd82eca3&quot;,&quot;parentUUID&quot;:&quot;9565b161-ccd3-47a2-aaba-4bad44de01f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;47907798-933e-4ac5-81b3-63a9a1dc3719&quot;,&quot;a7681b69-f542-4175-a83d-7f6fda76cc78&quot;,&quot;d518d115-2046-4fc2-a852-079b65ce47f7&quot;,&quot;1c57f0d6-c108-4122-9745-17d7fd82eca3&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;dfcc7b5d-90ba-49ba-86fb-4fd973042312&quot;,&quot;title&quot;:&quot;47. POST /conversations/:conversationId/messages - Send Message&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\08-conversation.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\08-conversation.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should send a message in a conversation&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 47. POST /conversations/:conversationId/messages - Send Message should send a message in a conversation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testConversationId) {\n  this.skip();\n  return;\n}\nconst messageData = {\n  message_text: &#x27;This is a test message from automated testing&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/conversations/${testConversationId}/messages`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(messageData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;message_id&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:303:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;c351936c-d328-42cb-937f-e7a4ba59e76f&quot;,&quot;parentUUID&quot;:&quot;dfcc7b5d-90ba-49ba-86fb-4fd973042312&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject sending message without authentication&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 47. POST /conversations/:conversationId/messages - Send Message should reject sending message without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testConversationId) {\n  this.skip();\n  return;\n}\nconst messageData = {\n  message_text: &#x27;Unauthorized message&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/conversations/${testConversationId}/messages`)\n  .send(messageData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:323:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;9b10bca3-86c7-4030-b533-7e51b5b93353&quot;,&quot;parentUUID&quot;:&quot;dfcc7b5d-90ba-49ba-86fb-4fd973042312&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject sending empty message&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 47. POST /conversations/:conversationId/messages - Send Message should reject sending empty message&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testConversationId) {\n  this.skip();\n  return;\n}\nconst messageData = {\n  message_text: &#x27;&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/conversations/${testConversationId}/messages`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(messageData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:341:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;671185c1-c917-4b55-b697-48abc782debb&quot;,&quot;parentUUID&quot;:&quot;dfcc7b5d-90ba-49ba-86fb-4fd973042312&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;c351936c-d328-42cb-937f-e7a4ba59e76f&quot;,&quot;9b10bca3-86c7-4030-b533-7e51b5b93353&quot;,&quot;671185c1-c917-4b55-b697-48abc782debb&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;5aa568be-f186-4945-82cc-67d6ed0a3d37&quot;,&quot;title&quot;:&quot;48. PATCH /conversations/:conversationId/read - Mark Messages as Read&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\08-conversation.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\08-conversation.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should mark messages as read&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 48. PATCH /conversations/:conversationId/read - Mark Messages as Read should mark messages as read&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testConversationId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/conversations/${testConversationId}/read`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`);\nvalidateSuccessResponse(res, 200);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:362:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;a9e06d01-d362-4d25-983c-2b88371fff3d&quot;,&quot;parentUUID&quot;:&quot;5aa568be-f186-4945-82cc-67d6ed0a3d37&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject marking messages as read without authentication&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 48. PATCH /conversations/:conversationId/read - Mark Messages as Read should reject marking messages as read without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testConversationId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .patch(`${apiPrefix}/conversations/${testConversationId}/read`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:376:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;a7d9d97c-9210-4ac4-8001-153c7639be28&quot;,&quot;parentUUID&quot;:&quot;5aa568be-f186-4945-82cc-67d6ed0a3d37&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;a9e06d01-d362-4d25-983c-2b88371fff3d&quot;,&quot;a7d9d97c-9210-4ac4-8001-153c7639be28&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;087a48c7-b3fc-4adf-807d-107f61bfb989&quot;,&quot;title&quot;:&quot;49. DELETE /conversations/:conversationId - Delete Conversation&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\08-conversation.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\08-conversation.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;49. DELETE /conversations/:conversationId - Delete Conversation\&quot;&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 49. DELETE /conversations/:conversationId - Delete Conversation \&quot;before all\&quot; hook in \&quot;49. DELETE /conversations/:conversationId - Delete Conversation\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Create a conversation to delete\nif (testListingId &amp;&amp; sellerId) {\n  const conversationData = {\n    listing_id: testListingId,\n    seller_id: sellerId,\n    initial_message: &#x27;This conversation will be deleted&#x27;\n  };\n  const res = await chai\n    .request(baseURL)\n    .post(`${apiPrefix}/conversations`)\n    .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n    .send(conversationData);\n  if (res.body.success) {\n    conversationToDelete = res.body.conversation_id;\n  }\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a3b41921-03c4-4fe1-a4b8-7d1509d5446d&quot;,&quot;parentUUID&quot;:&quot;087a48c7-b3fc-4adf-807d-107f61bfb989&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should delete a conversation&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 49. DELETE /conversations/:conversationId - Delete Conversation should delete a conversation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!conversationToDelete) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/conversations/${conversationToDelete}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateSuccessResponse(res, 200);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:414:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;f86172a2-aa8c-4191-b3e4-9e3500f37127&quot;,&quot;parentUUID&quot;:&quot;087a48c7-b3fc-4adf-807d-107f61bfb989&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject deleting conversation without authentication&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 49. DELETE /conversations/:conversationId - Delete Conversation should reject deleting conversation without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testConversationId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/conversations/${testConversationId}`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:428:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;7235936f-c035-4fc5-a0cd-72e209cfef4f&quot;,&quot;parentUUID&quot;:&quot;087a48c7-b3fc-4adf-807d-107f61bfb989&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for non-existent conversation&quot;,&quot;fullTitle&quot;:&quot;Conversation (Messaging) Endpoints 49. DELETE /conversations/:conversationId - Delete Conversation should return 404 for non-existent conversation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/conversations/999999`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/08-conversation.test.js:445:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 404\n&quot;},&quot;uuid&quot;:&quot;79fcc5f0-0f8e-4d9b-ac42-087d0b470c67&quot;,&quot;parentUUID&quot;:&quot;087a48c7-b3fc-4adf-807d-107f61bfb989&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;f86172a2-aa8c-4191-b3e4-9e3500f37127&quot;,&quot;7235936f-c035-4fc5-a0cd-72e209cfef4f&quot;,&quot;79fcc5f0-0f8e-4d9b-ac42-087d0b470c67&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;32988e79-77c6-4789-8823-b28973a93cc7&quot;,&quot;title&quot;:&quot;Guest Contact Endpoints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\09-guest-contact.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\09-guest-contact.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Guest Contact Endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints \&quot;before all\&quot; hook in \&quot;Guest Contact Endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:72,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Get an existing listing\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings?limit=1`);\nif (res.body.success &amp;&amp; res.body.listings.length &gt; 0) {\n  testListingId = res.body.listings[0].listing_id;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fc2c687c-2641-4b72-896a-ed00194a5ea4&quot;,&quot;parentUUID&quot;:&quot;32988e79-77c6-4789-8823-b28973a93cc7&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0f2c4517-b15a-44a1-8c3a-733fec19de0b&quot;,&quot;title&quot;:&quot;50. POST /guest-contacts - Submit Guest Contact&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\09-guest-contact.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\09-guest-contact.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should submit a guest contact inquiry&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 50. POST /guest-contacts - Submit Guest Contact should submit a guest contact inquiry&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst contactData = {\n  listing_id: testListingId,\n  guest_name: &#x27;John Doe&#x27;,\n  guest_email: &#x27;johndoe@example.com&#x27;,\n  guest_phone: &#x27;0812345678&#x27;,\n  message: &#x27;Hello, I am interested in this item. Can you provide more details?&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/guest-contacts`)\n  .send(contactData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;contact_id&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/09-guest-contact.test.js:42:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 201\n&quot;},&quot;uuid&quot;:&quot;033ed345-7902-4dc0-ba23-ea159e2f2a61&quot;,&quot;parentUUID&quot;:&quot;0f2c4517-b15a-44a1-8c3a-733fec19de0b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should submit guest contact with minimal required fields&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 50. POST /guest-contacts - Submit Guest Contact should submit guest contact with minimal required fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst contactData = {\n  listing_id: testListingId,\n  guest_name: &#x27;Jane Smith&#x27;,\n  guest_email: &#x27;janesmith@example.com&#x27;,\n  message: &#x27;Is this still available?&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/guest-contacts`)\n  .send(contactData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;contact_id&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/09-guest-contact.test.js:64:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 201\n&quot;},&quot;uuid&quot;:&quot;c5af7894-bfd3-4283-9503-8e69da6bc237&quot;,&quot;parentUUID&quot;:&quot;0f2c4517-b15a-44a1-8c3a-733fec19de0b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject guest contact with missing required fields&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 50. POST /guest-contacts - Submit Guest Contact should reject guest contact with missing required fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const contactData = {\n  guest_name: &#x27;Incomplete Contact&#x27;\n  // Missing listing_id, guest_email, message\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/guest-contacts`)\n  .send(contactData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bb7cca5b-7030-4517-b5fc-feda6bd0c820&quot;,&quot;parentUUID&quot;:&quot;0f2c4517-b15a-44a1-8c3a-733fec19de0b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject guest contact with invalid email&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 50. POST /guest-contacts - Submit Guest Contact should reject guest contact with invalid email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst contactData = {\n  listing_id: testListingId,\n  guest_name: &#x27;Bad Email&#x27;,\n  guest_email: &#x27;not-an-email&#x27;,\n  message: &#x27;Test message&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/guest-contacts`)\n  .send(contactData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3d31e8eb-f746-4bc4-abad-6f59bbe1e0c5&quot;,&quot;parentUUID&quot;:&quot;0f2c4517-b15a-44a1-8c3a-733fec19de0b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject guest contact for non-existent listing&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 50. POST /guest-contacts - Submit Guest Contact should reject guest contact for non-existent listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const contactData = {\n  listing_id: 999999,\n  guest_name: &#x27;Test User&#x27;,\n  guest_email: &#x27;test@example.com&#x27;,\n  message: &#x27;Test message&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/guest-contacts`)\n  .send(contactData);\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 400\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/09-guest-contact.test.js:116:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 404\n&quot;},&quot;uuid&quot;:&quot;b89c6fab-4efd-4de8-9bde-699f1d9ff707&quot;,&quot;parentUUID&quot;:&quot;0f2c4517-b15a-44a1-8c3a-733fec19de0b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow guest contact without authentication (public endpoint)&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 50. POST /guest-contacts - Submit Guest Contact should allow guest contact without authentication (public endpoint)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst contactData = {\n  listing_id: testListingId,\n  guest_name: &#x27;Anonymous Guest&#x27;,\n  guest_email: &#x27;anonymous@example.com&#x27;,\n  message: &#x27;Public inquiry test&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/guest-contacts`)\n  .send(contactData);\nvalidateSuccessResponse(res, 201);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 400&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 400\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/09-guest-contact.test.js:137:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 400\n+ 201\n&quot;},&quot;uuid&quot;:&quot;52155e43-4859-458f-a8d3-d6bac429f652&quot;,&quot;parentUUID&quot;:&quot;0f2c4517-b15a-44a1-8c3a-733fec19de0b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;bb7cca5b-7030-4517-b5fc-feda6bd0c820&quot;,&quot;3d31e8eb-f746-4bc4-abad-6f59bbe1e0c5&quot;],&quot;failures&quot;:[&quot;033ed345-7902-4dc0-ba23-ea159e2f2a61&quot;,&quot;c5af7894-bfd3-4283-9503-8e69da6bc237&quot;,&quot;b89c6fab-4efd-4de8-9bde-699f1d9ff707&quot;,&quot;52155e43-4859-458f-a8d3-d6bac429f652&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;cfc68f57-7314-41be-bc6c-b22648c2bf6f&quot;,&quot;title&quot;:&quot;51. GET /guest-contacts/listing/:listingId - Get Listing Guest Contacts&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\09-guest-contact.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\09-guest-contact.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get guest contacts for a listing as seller&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 51. GET /guest-contacts/listing/:listingId - Get Listing Guest Contacts should get guest contacts for a listing as seller&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/guest-contacts/listing/${testListingId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`);\nif (res.status === 200) {\n  validateSuccessResponse(res, 200);\n  expect(res.body).to.have.property(&#x27;contacts&#x27;);\n  expect(res.body.contacts).to.be.an(&#x27;array&#x27;);\n} else if (res.status === 403) {\n  // If seller1 doesn&#x27;t own this listing\n  validateErrorResponse(res, 403);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a6ac6efc-19f4-4212-8c1b-ee195bc6c158&quot;,&quot;parentUUID&quot;:&quot;cfc68f57-7314-41be-bc6c-b22648c2bf6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should paginate listing guest contacts&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 51. GET /guest-contacts/listing/:listingId - Get Listing Guest Contacts should paginate listing guest contacts&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/guest-contacts/listing/${testListingId}?limit=10&amp;offset=0`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`);\nif (res.status === 200) {\n  validateSuccessResponse(res, 200);\n  expect(res.body.contacts).to.be.an(&#x27;array&#x27;);\n} else {\n  expect(res.status).to.be.oneOf([200, 403]);\n}&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 401 to be one of [ 200, 403 ]&quot;,&quot;estack&quot;:&quot;AssertionError: expected 401 to be one of [ 200, 403 ]\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/09-guest-contact.test.js:178:34)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;ea5caab7-e923-4a5a-ad81-e5864a52b13e&quot;,&quot;parentUUID&quot;:&quot;cfc68f57-7314-41be-bc6c-b22648c2bf6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting guest contacts without authentication&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 51. GET /guest-contacts/listing/:listingId - Get Listing Guest Contacts should reject getting guest contacts without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/guest-contacts/listing/${testListingId}`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fbcaa40b-30e2-47e6-8e9e-048dd1781e2d&quot;,&quot;parentUUID&quot;:&quot;cfc68f57-7314-41be-bc6c-b22648c2bf6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting guest contacts by non-owner&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 51. GET /guest-contacts/listing/:listingId - Get Listing Guest Contacts should reject getting guest contacts by non-owner&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/guest-contacts/listing/${testListingId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/09-guest-contact.test.js:206:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;be59b906-52ed-4ba8-8260-eada2a4f30b8&quot;,&quot;parentUUID&quot;:&quot;cfc68f57-7314-41be-bc6c-b22648c2bf6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a6ac6efc-19f4-4212-8c1b-ee195bc6c158&quot;,&quot;fbcaa40b-30e2-47e6-8e9e-048dd1781e2d&quot;],&quot;failures&quot;:[&quot;ea5caab7-e923-4a5a-ad81-e5864a52b13e&quot;,&quot;be59b906-52ed-4ba8-8260-eada2a4f30b8&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;d9283fb7-648c-41ba-abf0-de0939293d32&quot;,&quot;title&quot;:&quot;52. GET /guest-contacts/my-contacts - Get All Seller&#x27;s Guest Contacts&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\09-guest-contact.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\09-guest-contact.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get all guest contacts for the authenticated seller&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 52. GET /guest-contacts/my-contacts - Get All Seller&#x27;s Guest Contacts should get all guest contacts for the authenticated seller&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/guest-contacts/my-contacts`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;contacts&#x27;);\nexpect(res.body.contacts).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/09-guest-contact.test.js:217:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;c8a515a0-14bc-4bdb-bf52-f084b03ecb1a&quot;,&quot;parentUUID&quot;:&quot;d9283fb7-648c-41ba-abf0-de0939293d32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should paginate seller&#x27;s guest contacts&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 52. GET /guest-contacts/my-contacts - Get All Seller&#x27;s Guest Contacts should paginate seller&#x27;s guest contacts&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/guest-contacts/my-contacts?limit=20&amp;offset=0`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`);\nvalidateSuccessResponse(res, 200);\nexpect(res.body.contacts).to.be.an(&#x27;array&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/09-guest-contact.test.js:228:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;c896978f-7127-43eb-a39e-35e4462857a0&quot;,&quot;parentUUID&quot;:&quot;d9283fb7-648c-41ba-abf0-de0939293d32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting contacts without authentication&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 52. GET /guest-contacts/my-contacts - Get All Seller&#x27;s Guest Contacts should reject getting contacts without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/guest-contacts/my-contacts`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3b6d5029-95c8-4654-99e6-b13d563e0c97&quot;,&quot;parentUUID&quot;:&quot;d9283fb7-648c-41ba-abf0-de0939293d32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject getting contacts by non-seller&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 52. GET /guest-contacts/my-contacts - Get All Seller&#x27;s Guest Contacts should reject getting contacts by non-seller&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/guest-contacts/my-contacts`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/09-guest-contact.test.js:246:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;aa658e49-39eb-4a75-9748-badf563524f1&quot;,&quot;parentUUID&quot;:&quot;d9283fb7-648c-41ba-abf0-de0939293d32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return empty array for seller with no contacts&quot;,&quot;fullTitle&quot;:&quot;Guest Contact Endpoints 52. GET /guest-contacts/my-contacts - Get All Seller&#x27;s Guest Contacts should return empty array for seller with no contacts&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:37,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// seller2 might not have any contacts\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signin`)\n  .send({\n    email: global.testAccounts.seller2.email,\n    password: global.testAccounts.seller2.password\n  });\nif (res.body.success) {\n  const seller2Token = res.body.token;\n  const contactsRes = await chai\n    .request(baseURL)\n    .get(`${apiPrefix}/guest-contacts/my-contacts`)\n    .set(&#x27;Authorization&#x27;, `Bearer ${seller2Token}`);\n  validateSuccessResponse(contactsRes, 200);\n  expect(contactsRes.body.contacts).to.be.an(&#x27;array&#x27;);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;907c15d6-3dce-4f6d-af7e-2454c160f4dc&quot;,&quot;parentUUID&quot;:&quot;d9283fb7-648c-41ba-abf0-de0939293d32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3b6d5029-95c8-4654-99e6-b13d563e0c97&quot;,&quot;907c15d6-3dce-4f6d-af7e-2454c160f4dc&quot;],&quot;failures&quot;:[&quot;c8a515a0-14bc-4bdb-bf52-f084b03ecb1a&quot;,&quot;c896978f-7127-43eb-a39e-35e4462857a0&quot;,&quot;aa658e49-39eb-4a75-9748-badf563524f1&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:45,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;5bf71818-8a3a-4647-9a82-956ac41d52c4&quot;,&quot;title&quot;:&quot;Admin Endpoints&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\10-admin.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\10-admin.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Admin Endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints \&quot;before all\&quot; hook in \&quot;Admin Endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:143,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Get an existing listing\nconst listingsRes = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/listings?limit=1`);\nif (listingsRes.body.success &amp;&amp; listingsRes.body.listings.length &gt; 0) {\n  testListingId = listingsRes.body.listings[0].listing_id;\n}\n// Get an existing category\nconst categoriesRes = await chai\n  .request(baseURL)\n  .get(`${apiPrefix}/categories`);\nif (categoriesRes.body.success &amp;&amp; categoriesRes.body.categories.length &gt; 0) {\n  testCategoryId = categoriesRes.body.categories[0].category_id;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c483da39-9015-4001-9817-b844249a74c7&quot;,&quot;parentUUID&quot;:&quot;5bf71818-8a3a-4647-9a82-956ac41d52c4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;faacfd7f-100f-4f2d-9eef-0f731a6aa484&quot;,&quot;title&quot;:&quot;53. POST /admin/users - Create Admin Account&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\10-admin.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\10-admin.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create admin account with super admin credentials&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 53. POST /admin/users - Create Admin Account should create admin account with super admin credentials&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const adminData = {\n  email: `admin_test_${Date.now()}@marketplace.com`,\n  password: &#x27;adminpassword123&#x27;,\n  username: `admin_test_${Date.now()}`,\n  first_name: &#x27;Admin&#x27;,\n  last_name: &#x27;Test&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/admin/users`)\n  .auth(global.testAccounts.superAdmin.email, global.testAccounts.superAdmin.password)\n  .send(adminData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;id&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:49:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 201\n&quot;},&quot;uuid&quot;:&quot;acd1d052-7d14-4c05-9913-cc010c1078ba&quot;,&quot;parentUUID&quot;:&quot;faacfd7f-100f-4f2d-9eef-0f731a6aa484&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject admin creation without super admin auth&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 53. POST /admin/users - Create Admin Account should reject admin creation without super admin auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const adminData = {\n  email: `admin_noauth_${Date.now()}@marketplace.com`,\n  password: &#x27;adminpassword123&#x27;,\n  username: `admin_noauth_${Date.now()}`,\n  first_name: &#x27;No&#x27;,\n  last_name: &#x27;Auth&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/admin/users`)\n  .send(adminData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:97:28)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:67:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;e06ef5f4-f260-4ace-97da-65e5216e2953&quot;,&quot;parentUUID&quot;:&quot;faacfd7f-100f-4f2d-9eef-0f731a6aa484&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject admin creation with JWT token (must use Basic Auth)&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 53. POST /admin/users - Create Admin Account should reject admin creation with JWT token (must use Basic Auth)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const adminData = {\n  email: `admin_jwt_${Date.now()}@marketplace.com`,\n  password: &#x27;adminpassword123&#x27;,\n  username: `admin_jwt_${Date.now()}`,\n  first_name: &#x27;JWT&#x27;,\n  last_name: &#x27;Test&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/admin/users`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send(adminData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:97:28)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:85:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;5f2003ca-bd9b-48aa-91b7-fda6fe59d560&quot;,&quot;parentUUID&quot;:&quot;faacfd7f-100f-4f2d-9eef-0f731a6aa484&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject admin creation with missing required fields&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 53. POST /admin/users - Create Admin Account should reject admin creation with missing required fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const adminData = {\n  email: `incomplete_${Date.now()}@marketplace.com`\n  // Missing password, username, first_name, last_name\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/admin/users`)\n  .auth(global.testAccounts.superAdmin.email, global.testAccounts.superAdmin.password)\n  .send(adminData);\nvalidateErrorResponse(res, 400);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 400 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:100:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 400\n&quot;},&quot;uuid&quot;:&quot;7907bc2d-7a92-42d5-b0c9-a914842582e9&quot;,&quot;parentUUID&quot;:&quot;faacfd7f-100f-4f2d-9eef-0f731a6aa484&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;acd1d052-7d14-4c05-9913-cc010c1078ba&quot;,&quot;e06ef5f4-f260-4ace-97da-65e5216e2953&quot;,&quot;5f2003ca-bd9b-48aa-91b7-fda6fe59d560&quot;,&quot;7907bc2d-7a92-42d5-b0c9-a914842582e9&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:16,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;33502054-8244-4dea-a792-d77119eaa719&quot;,&quot;title&quot;:&quot;54. DELETE /admin/users/:id - Delete User Account&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\10-admin.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\10-admin.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;54. DELETE /admin/users/:id - Delete User Account\&quot;&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 54. DELETE /admin/users/:id - Delete User Account \&quot;before all\&quot; hook in \&quot;54. DELETE /admin/users/:id - Delete User Account\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:105,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Create a user to delete\nconst userData = {\n  email: `todelete_admin_${Date.now()}@example.com`,\n  password: &#x27;password123&#x27;,\n  username: `todelete_admin_${Date.now()}`,\n  first_name: &#x27;To&#x27;,\n  last_name: &#x27;Delete&#x27;,\n  role: &#x27;buyer&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signup`)\n  .send(userData);\nif (res.body.success) {\n  testUserId = res.body.id;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c20b33ae-f132-4b57-b8e7-7b92792da010&quot;,&quot;parentUUID&quot;:&quot;33502054-8244-4dea-a792-d77119eaa719&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should delete user with super admin credentials&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 54. DELETE /admin/users/:id - Delete User Account should delete user with super admin credentials&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testUserId) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/admin/users/${testUserId}`)\n  .auth(global.testAccounts.superAdmin.email, global.testAccounts.superAdmin.password);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;deletedUser&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:137:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;788bf568-e8fb-454a-86eb-fa269e065263&quot;,&quot;parentUUID&quot;:&quot;33502054-8244-4dea-a792-d77119eaa719&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject user deletion without super admin auth&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 54. DELETE /admin/users/:id - Delete User Account should reject user deletion without super admin auth&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/admin/users/999`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected { Object (message) } to have property &#x27;success&#x27;\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:97:28)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:146:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;},&quot;uuid&quot;:&quot;bc07390d-7e43-4102-a282-f6a89a506218&quot;,&quot;parentUUID&quot;:&quot;33502054-8244-4dea-a792-d77119eaa719&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for non-existent user&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 54. DELETE /admin/users/:id - Delete User Account should return 404 for non-existent user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/admin/users/999999`)\n  .auth(global.testAccounts.superAdmin.email, global.testAccounts.superAdmin.password);\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:155:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 404\n&quot;},&quot;uuid&quot;:&quot;30967778-285f-411a-9241-e0addcc4cef8&quot;,&quot;parentUUID&quot;:&quot;33502054-8244-4dea-a792-d77119eaa719&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;788bf568-e8fb-454a-86eb-fa269e065263&quot;,&quot;bc07390d-7e43-4102-a282-f6a89a506218&quot;,&quot;30967778-285f-411a-9241-e0addcc4cef8&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;53418735-b360-469d-ab0e-7a7f548111fd&quot;,&quot;title&quot;:&quot;55. POST /admin/categories - Create Category&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\10-admin.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\10-admin.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create category as admin&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 55. POST /admin/categories - Create Category should create category as admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const categoryData = {\n  category_name: `Admin Category ${Date.now()}`,\n  slug: `admin-category-${Date.now()}`,\n  description: &#x27;Category created by admin endpoint&#x27;,\n  icon_url: &#x27;https://example.com/icon.png&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/admin/categories`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send(categoryData);\nvalidateSuccessResponse(res, 201);\nexpect(res.body).to.have.property(&#x27;category_id&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 201 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:174:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 201\n&quot;},&quot;uuid&quot;:&quot;c585170b-c337-4614-be55-a0da018194d5&quot;,&quot;parentUUID&quot;:&quot;53418735-b360-469d-ab0e-7a7f548111fd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category creation without authentication&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 55. POST /admin/categories - Create Category should reject category creation without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const categoryData = {\n  category_name: &#x27;No Auth Category&#x27;,\n  slug: &#x27;no-auth-category&#x27;,\n  description: &#x27;Should fail&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/admin/categories`)\n  .send(categoryData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;86ab1d9e-196d-44fb-8cce-618f09a7e117&quot;,&quot;parentUUID&quot;:&quot;53418735-b360-469d-ab0e-7a7f548111fd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category creation by non-admin&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 55. POST /admin/categories - Create Category should reject category creation by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const categoryData = {\n  category_name: &#x27;Seller Category&#x27;,\n  slug: &#x27;seller-category&#x27;,\n  description: &#x27;Created by seller&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/admin/categories`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send(categoryData);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:206:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;6cab5402-024f-47f4-b221-d381e3b185bc&quot;,&quot;parentUUID&quot;:&quot;53418735-b360-469d-ab0e-7a7f548111fd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;86ab1d9e-196d-44fb-8cce-618f09a7e117&quot;],&quot;failures&quot;:[&quot;c585170b-c337-4614-be55-a0da018194d5&quot;,&quot;6cab5402-024f-47f4-b221-d381e3b185bc&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;a64e6788-8596-4c26-a889-5794f51ed72f&quot;,&quot;title&quot;:&quot;56. PUT /admin/categories/:id - Update Category&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\10-admin.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\10-admin.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should update category as admin&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 56. PUT /admin/categories/:id - Update Category should update category as admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testCategoryId) {\n  this.skip();\n  return;\n}\nconst updateData = {\n  description: `Updated description ${Date.now()}`\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/admin/categories/${testCategoryId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send(updateData);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;category&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:227:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;f674cef0-aa08-459f-a262-8c3f0cf0fcce&quot;,&quot;parentUUID&quot;:&quot;a64e6788-8596-4c26-a889-5794f51ed72f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category update without authentication&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 56. PUT /admin/categories/:id - Update Category should reject category update without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testCategoryId) {\n  this.skip();\n  return;\n}\nconst updateData = {\n  description: &#x27;Unauthorized update&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/admin/categories/${testCategoryId}`)\n  .send(updateData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0f8c9ca0-c522-4b53-b90b-e48a74dc530a&quot;,&quot;parentUUID&quot;:&quot;a64e6788-8596-4c26-a889-5794f51ed72f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category update by non-admin&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 56. PUT /admin/categories/:id - Update Category should reject category update by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testCategoryId) {\n  this.skip();\n  return;\n}\nconst updateData = {\n  description: &#x27;Buyer update&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/admin/categories/${testCategoryId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(updateData);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:265:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;037b5d79-e940-438f-a849-3eea5e34b114&quot;,&quot;parentUUID&quot;:&quot;a64e6788-8596-4c26-a889-5794f51ed72f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0f8c9ca0-c522-4b53-b90b-e48a74dc530a&quot;],&quot;failures&quot;:[&quot;f674cef0-aa08-459f-a262-8c3f0cf0fcce&quot;,&quot;037b5d79-e940-438f-a849-3eea5e34b114&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;ae262903-fa8e-4220-a102-5582819b109f&quot;,&quot;title&quot;:&quot;57. DELETE /admin/categories/:id - Delete Category&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\10-admin.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\10-admin.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;57. DELETE /admin/categories/:id - Delete Category\&quot;&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 57. DELETE /admin/categories/:id - Delete Category \&quot;before all\&quot; hook in \&quot;57. DELETE /admin/categories/:id - Delete Category\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Create a category to delete\nconst categoryData = {\n  category_name: `To Delete ${Date.now()}`,\n  slug: `to-delete-${Date.now()}`,\n  description: &#x27;Will be deleted&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/admin/categories`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send(categoryData);\nif (res.body.success) {\n  categoryToDelete = res.body.category_id;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4e55f4d5-028f-4743-80a2-291d333b98db&quot;,&quot;parentUUID&quot;:&quot;ae262903-fa8e-4220-a102-5582819b109f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should delete category as admin&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 57. DELETE /admin/categories/:id - Delete Category should delete category as admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!categoryToDelete) {\n  this.skip();\n  return;\n}\nconst res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/admin/categories/${categoryToDelete}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`);\nvalidateSuccessResponse(res, 200);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: this.skip is not a function&quot;,&quot;estack&quot;:&quot;TypeError: this.skip is not a function\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:293:14)\n    at process.processImmediate (node:internal/timers:485:21)&quot;},&quot;uuid&quot;:&quot;6467b141-e2a7-43f2-a607-2aa0ec20cf00&quot;,&quot;parentUUID&quot;:&quot;ae262903-fa8e-4220-a102-5582819b109f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category deletion without authentication&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 57. DELETE /admin/categories/:id - Delete Category should reject category deletion without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/admin/categories/999`);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d8d251fb-fbaa-4d7f-9da7-0b6d69591b84&quot;,&quot;parentUUID&quot;:&quot;ae262903-fa8e-4220-a102-5582819b109f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject category deletion by non-admin&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 57. DELETE /admin/categories/:id - Delete Category should reject category deletion by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n  .request(baseURL)\n  .delete(`${apiPrefix}/admin/categories/999`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:319:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;410b5c78-ed3e-4e41-a2ea-779fc42d5df2&quot;,&quot;parentUUID&quot;:&quot;ae262903-fa8e-4220-a102-5582819b109f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;d8d251fb-fbaa-4d7f-9da7-0b6d69591b84&quot;],&quot;failures&quot;:[&quot;6467b141-e2a7-43f2-a607-2aa0ec20cf00&quot;,&quot;410b5c78-ed3e-4e41-a2ea-779fc42d5df2&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;87cca9ae-95f6-4074-af24-f9e8e90eaa16&quot;,&quot;title&quot;:&quot;58. PUT /admin/users/:id - Edit User Profile&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\10-admin.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\10-admin.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;58. PUT /admin/users/:id - Edit User Profile\&quot;&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 58. PUT /admin/users/:id - Edit User Profile \&quot;before all\&quot; hook in \&quot;58. PUT /admin/users/:id - Edit User Profile\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:104,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Create a user to edit\nconst userData = {\n  email: `toedit_${Date.now()}@example.com`,\n  password: &#x27;password123&#x27;,\n  username: `toedit_${Date.now()}`,\n  first_name: &#x27;To&#x27;,\n  last_name: &#x27;Edit&#x27;,\n  role: &#x27;buyer&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .post(`${apiPrefix}/users/signup`)\n  .send(userData);\nif (res.body.success) {\n  userToEdit = res.body.id;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;115c7923-bb7e-433e-9522-fc1030eaebf0&quot;,&quot;parentUUID&quot;:&quot;87cca9ae-95f6-4074-af24-f9e8e90eaa16&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should edit user profile as admin&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 58. PUT /admin/users/:id - Edit User Profile should edit user profile as admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!userToEdit) {\n  this.skip();\n  return;\n}\nconst updateData = {\n  first_name: &#x27;Edited&#x27;,\n  last_name: &#x27;ByAdmin&#x27;,\n  status: &#x27;active&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/admin/users/${userToEdit}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send(updateData);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;user&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:365:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;bd67d3b3-dd13-4f2b-9e09-47202429c3db&quot;,&quot;parentUUID&quot;:&quot;87cca9ae-95f6-4074-af24-f9e8e90eaa16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject user edit without authentication&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 58. PUT /admin/users/:id - Edit User Profile should reject user edit without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!userToEdit) {\n  this.skip();\n  return;\n}\nconst updateData = {\n  first_name: &#x27;Unauthorized&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/admin/users/${userToEdit}`)\n  .send(updateData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;db71270b-06c2-4c07-9956-5c107367c900&quot;,&quot;parentUUID&quot;:&quot;87cca9ae-95f6-4074-af24-f9e8e90eaa16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject user edit by non-admin&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 58. PUT /admin/users/:id - Edit User Profile should reject user edit by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!userToEdit) {\n  this.skip();\n  return;\n}\nconst updateData = {\n  first_name: &#x27;Seller Edit&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/admin/users/${userToEdit}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.seller1}`)\n  .send(updateData);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:403:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;cabb0a76-b088-49c2-902a-440f81d1a08b&quot;,&quot;parentUUID&quot;:&quot;87cca9ae-95f6-4074-af24-f9e8e90eaa16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for non-existent user&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 58. PUT /admin/users/:id - Edit User Profile should return 404 for non-existent user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updateData = {\n  first_name: &#x27;Not Found&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/admin/users/999999`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send(updateData);\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:417:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 404\n&quot;},&quot;uuid&quot;:&quot;54a95608-6174-47cf-8a7b-bf10f456629c&quot;,&quot;parentUUID&quot;:&quot;87cca9ae-95f6-4074-af24-f9e8e90eaa16&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;db71270b-06c2-4c07-9956-5c107367c900&quot;],&quot;failures&quot;:[&quot;bd67d3b3-dd13-4f2b-9e09-47202429c3db&quot;,&quot;cabb0a76-b088-49c2-902a-440f81d1a08b&quot;,&quot;54a95608-6174-47cf-8a7b-bf10f456629c&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000},{&quot;uuid&quot;:&quot;4993e96a-66c7-4605-b72f-53efb70cfe32&quot;,&quot;title&quot;:&quot;59. PUT /admin/listings/:id - Edit Listing&quot;,&quot;fullFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\test\\api\\10-admin.test.js&quot;,&quot;file&quot;:&quot;\\test\\api\\10-admin.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should edit listing as admin&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 59. PUT /admin/listings/:id - Edit Listing should edit listing as admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst updateData = {\n  title: `Admin Edited ${Date.now()}`,\n  description: &#x27;Edited by admin for testing&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/admin/listings/${testListingId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send(updateData);\nvalidateSuccessResponse(res, 200);\nexpect(res.body).to.have.property(&#x27;listing&#x27;);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 200 but got 401\n    at validateSuccessResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:85:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:439:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 200\n&quot;},&quot;uuid&quot;:&quot;eae5faca-7fae-48a4-87eb-8dfba66ec44b&quot;,&quot;parentUUID&quot;:&quot;4993e96a-66c7-4605-b72f-53efb70cfe32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject listing edit without authentication&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 59. PUT /admin/listings/:id - Edit Listing should reject listing edit without authentication&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst updateData = {\n  title: &#x27;No Auth Edit&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/admin/listings/${testListingId}`)\n  .send(updateData);\nvalidateErrorResponse(res, 401);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c84509f7-c9aa-4a10-9e31-ed92e25540a4&quot;,&quot;parentUUID&quot;:&quot;4993e96a-66c7-4605-b72f-53efb70cfe32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should reject listing edit by non-admin&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 59. PUT /admin/listings/:id - Edit Listing should reject listing edit by non-admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (!testListingId) {\n  this.skip();\n  return;\n}\nconst updateData = {\n  title: &#x27;Buyer Edit&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/admin/listings/${testListingId}`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.buyer1}`)\n  .send(updateData);\nvalidateErrorResponse(res, 403);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 403 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:477:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 403\n&quot;},&quot;uuid&quot;:&quot;10a07e3f-62fe-4bf7-9629-19edda79a486&quot;,&quot;parentUUID&quot;:&quot;4993e96a-66c7-4605-b72f-53efb70cfe32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return 404 for non-existent listing&quot;,&quot;fullTitle&quot;:&quot;Admin Endpoints 59. PUT /admin/listings/:id - Edit Listing should return 404 for non-existent listing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const updateData = {\n  title: &#x27;Not Found&#x27;\n};\nconst res = await chai\n  .request(baseURL)\n  .put(`${apiPrefix}/admin/listings/999999`)\n  .set(&#x27;Authorization&#x27;, `Bearer ${tokens.admin}`)\n  .send(updateData);\nvalidateErrorResponse(res, 404);&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401&quot;,&quot;estack&quot;:&quot;AssertionError: expected Response{ _events: {}, …(35), …(2) } to have status code 404 but got 401\n    at validateErrorResponse (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/helpers.js:95:23)\n    at Context.&lt;anonymous&gt; (file:///C:/Users/PC/Documents/BLOW_JOB/csi400/c2c_project/ver12/backend/test/api/10-admin.test.js:491:7)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)&quot;,&quot;diff&quot;:&quot;- 401\n+ 404\n&quot;},&quot;uuid&quot;:&quot;be396ccb-3b22-44b1-9b2d-cdb0f8812a7c&quot;,&quot;parentUUID&quot;:&quot;4993e96a-66c7-4605-b72f-53efb70cfe32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c84509f7-c9aa-4a10-9e31-ed92e25540a4&quot;],&quot;failures&quot;:[&quot;eae5faca-7fae-48a4-87eb-8dfba66ec44b&quot;,&quot;10a07e3f-62fe-4bf7-9629-19edda79a486&quot;,&quot;be396ccb-3b22-44b1-9b2d-cdb0f8812a7c&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:30000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:30000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;11.7.5&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.4&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;[object Object]&quot;:true},&quot;version&quot;:&quot;6.3.2&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;mochawesome-report&quot;,&quot;reportTitle&quot;:&quot;backend&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;mochawesome-report\\assets&quot;,&quot;jsonFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\mochawesome-report\\mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;C:\\Users\\PC\\Documents\\BLOW_JOB\\csi400\\c2c_project\\ver12\\backend\\mochawesome-report\\mochawesome.html&quot;}"><div id="report"></div><script src="assets\app.js"></script></body></html>